<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Sheets Frontend - Performance Monitor</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            padding: 40px;
            width: 100%;
            max-width: 900px;
            animation: slideUp 0.5s ease-out;
        }
        
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 10px;
            font-size: 2.5em;
        }
        
        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 1.1em;
        }
        
        .controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }
        
        button {
            padding: 15px 25px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .btn-a {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .btn-b {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }
        
        .btn-append {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            grid-column: span 2;
        }
        
        .performance-panel {
            background: #1a1a2e;
            color: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        
        .metric {
            background: #162447;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }
        
        .metric-title {
            font-size: 0.9em;
            color: #a9a9a9;
            margin-bottom: 5px;
        }
        
        .metric-value {
            font-size: 1.8em;
            font-weight: bold;
            color: #4facfe;
        }
        
        .metric-unit {
            font-size: 0.8em;
            color: #a9a9a9;
            margin-left: 5px;
        }
        
        .metric-detail {
            font-size: 0.9em;
            color: #e6e6e6;
            margin-top: 5px;
        }
        
        .status {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }
        
        .status.loading {
            background: #e3f2fd;
            color: #1976d2;
        }
        
        .status.error {
            background: #ffebee;
            color: #d32f2f;
        }
        
        .status.success {
            background: #e8f5e9;
            color: #388e3c;
        }
        
        .results-container {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            max-height: 400px;
            overflow-y: auto;
        }
        
        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e0e0e0;
        }
        
        .results-title {
            font-size: 1.2em;
            font-weight: 600;
            color: #333;
        }
        
        .action-badge {
            background: #333;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9em;
        }
        
        .data-list {
            list-style: none;
        }
        
        .data-item {
            padding: 12px 15px;
            margin: 8px 0;
            background: white;
            border-radius: 8px;
            border-left: 4px solid #667eea;
            display: flex;
            align-items: center;
            gap: 10px;
            animation: fadeIn 0.3s ease-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateX(-10px); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        .data-index {
            background: #667eea;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }
        
        .no-data {
            text-align: center;
            color: #999;
            padding: 20px;
            font-style: italic;
        }
        
        .instructions {
            background: #e3f2fd;
            border-radius: 10px;
            padding: 15px;
            margin-top: 30px;
            font-size: 0.9em;
            color: #1976d2;
        }
        
        .log {
            font-family: 'Courier New', monospace;
            background: #1a1a2e;
            color: #4facfe;
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            font-size: 0.85em;
            overflow-x: auto;
            max-height: 200px;
            overflow-y: auto;
            border: 1px solid #333;
        }
        
        .log-entry {
            margin-bottom: 5px;
            padding: 5px;
            border-bottom: 1px solid #333;
        }
        
        .log-time {
            color: #00f2fe;
            font-weight: bold;
        }
        
        .log-action {
            color: #f093fb;
            font-weight: bold;
        }
        
        .log-duration {
            color: #4CAF50;
            font-weight: bold;
        }
        
        .log-error {
            color: #ff6b6b;
        }
        
        .log-success {
            color: #4CAF50;
        }
        
        .timeline {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 20px 0;
            position: relative;
        }
        
        .timeline::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 2px;
            background: #e0e0e0;
            z-index: 1;
        }
        
        .timeline-point {
            position: relative;
            z-index: 2;
            background: white;
            border: 3px solid #667eea;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #667eea;
        }
        
        .timeline-point.active {
            background: #667eea;
            color: white;
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(102, 126, 234, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(102, 126, 234, 0); }
            100% { box-shadow: 0 0 0 0 rgba(102, 126, 234, 0); }
        }
        
        .timeline-label {
            position: absolute;
            top: 40px;
            font-size: 0.8em;
            color: #666;
            text-align: center;
            width: 100px;
        }
        
        .chart-container {
            height: 100px;
            margin: 20px 0;
            background: #f8f9fa;
            border-radius: 10px;
            padding: 10px;
            position: relative;
            overflow: hidden;
        }
        
        .chart-bar {
            position: absolute;
            bottom: 0;
            width: 30px;
            background: linear-gradient(to top, #667eea, #764ba2);
            border-radius: 5px 5px 0 0;
            transition: height 0.5s ease;
        }
        
        .chart-label {
            position: absolute;
            bottom: -25px;
            font-size: 0.8em;
            text-align: center;
            width: 30px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>‚è±Ô∏è Google Sheets Performance Monitor</h1>
        <p class="subtitle">ƒêo th·ªùi gian x·ª≠ l√Ω to√†n tr√¨nh d·ªØ li·ªáu</p>
        
        <div class="controls">
            <button class="btn-a" onclick="fetchData('A')">
                <span>üìã</span> L·∫•y Config A
            </button>
            <button class="btn-b" onclick="fetchData('B')">
                <span>üìÑ</span> L·∫•y Config B
            </button>
            <button class="btn-append" onclick="appendData()">
                <span>üìù</span> Ghi Log
            </button>
        </div>
        
        <!-- Performance Metrics Panel -->
        <div class="performance-panel">
            <div class="metric">
                <div class="metric-title">Th·ªùi gian l·∫•y Config A</div>
                <div>
                    <span class="metric-value" id="configATime">0.00</span>
                    <span class="metric-unit">gi√¢y</span>
                </div>
                <div class="metric-detail" id="configADetail">Ch∆∞a ƒëo</div>
            </div>
            
            <div class="metric">
                <div class="metric-title">Th·ªùi gian l·∫•y Config B</div>
                <div>
                    <span class="metric-value" id="configBTime">0.00</span>
                    <span class="metric-unit">gi√¢y</span>
                </div>
                <div class="metric-detail" id="configBDetail">Ch∆∞a ƒëo</div>
            </div>
            
            <div class="metric">
                <div class="metric-title">Th·ªùi gian ghi Log</div>
                <div>
                    <span class="metric-value" id="appendTime">0.00</span>
                    <span class="metric-unit">gi√¢y</span>
                </div>
                <div class="metric-detail" id="appendDetail">Ch∆∞a ƒëo</div>
            </div>
            
            <div class="metric">
                <div class="metric-title">Trung b√¨nh</div>
                <div>
                    <span class="metric-value" id="avgTime">0.00</span>
                    <span class="metric-unit">gi√¢y</span>
                </div>
                <div class="metric-detail" id="avgDetail">0 l∆∞·ª£t ƒëo</div>
            </div>
        </div>
        
        <!-- Timeline Visualization -->
        <div class="timeline">
            <div class="timeline-point" id="timelineStart">1</div>
            <div class="timeline-point" id="timelineRequest">2</div>
            <div class="timeline-point" id="timelineProcessing">3</div>
            <div class="timeline-point" id="timelineResponse">4</div>
            <div class="timeline-point" id="timelineComplete">5</div>
        </div>
        
        <div class="timeline" style="margin-top: 40px;">
            <div class="timeline-label" style="left: 0;">B·∫Øt ƒë·∫ßu</div>
            <div class="timeline-label" style="left: 20%;">G·ª≠i request</div>
            <div class="timeline-label" style="left: 40%;">X·ª≠ l√Ω server</div>
            <div class="timeline-label" style="left: 60%;">Nh·∫≠n response</div>
            <div class="timeline-label" style="left: 80%;">Hi·ªÉn th·ªã UI</div>
        </div>
        
        <div class="chart-container" id="chartContainer">
            <!-- Chart bars will be added dynamically -->
        </div>
        
        <div id="status" class="status">
            üëÜ Nh·∫•n v√†o n√∫t b√™n tr√™n ƒë·ªÉ b·∫Øt ƒë·∫ßu ƒëo th·ªùi gian
        </div>
        
        <div class="results-container">
            <div class="results-header">
                <span class="results-title">üìà K·∫øt Qu·∫£ D·ªØ Li·ªáu</span>
                <span id="actionBadge" class="action-badge">Ch∆∞a c√≥</span>
            </div>
            <ul id="results" class="data-list">
                <li class="no-data">Ch∆∞a c√≥ d·ªØ li·ªáu n√†o ƒë∆∞·ª£c t·∫£i</li>
            </ul>
        </div>
        
        <!-- Performance Log -->
        <div class="log">
            <div style="color: #fff; font-weight: bold; margin-bottom: 10px;">üìä Performance Log</div>
            <div id="logEntries">
                <div class="log-entry">
                    <span class="log-time">[00:00:00]</span>
                    <span class="log-action">H·ªá th·ªëng ƒë√£ s·∫µn s√†ng</span>
                </div>
            </div>
        </div>
        
        <div class="instructions">
            <strong>üìù H∆∞·ªõng d·∫´n ƒëo th·ªùi gian:</strong>
            <p>1. <strong>Config A/B</strong>: Th·ªùi gian t·ª´ l√∫c b·∫•m n√∫t ƒë·∫øn khi HTML nh·∫≠n ƒë∆∞·ª£c d·ªØ li·ªáu</p>
            <p>2. <strong>Ghi Log</strong>: Th·ªùi gian t·ª´ l√∫c b·∫•m n√∫t ƒë·∫øn khi nh·∫≠n x√°c nh·∫≠n d·ªØ li·ªáu ƒë√£ ƒë∆∞·ª£c ghi</p>
            <p>3. Timeline hi·ªÉn th·ªã 5 b∆∞·ªõc: B·∫Øt ƒë·∫ßu ‚Üí G·ª≠i request ‚Üí X·ª≠ l√Ω server ‚Üí Nh·∫≠n response ‚Üí Hi·ªÉn th·ªã UI</p>
        </div>
    </div>

    <script>
        // ‚ö†Ô∏è THAY ƒê·ªîI URL N√ÄY TH√ÄNH URL WEB APP C·ª¶A B·∫†N
        const scriptUrl = 'https://script.google.com/macros/s/AKfycbwLfp8elga_zQqpNvomtC_0eBraWLycr-u2zEQgfRPJs0FKZvY3pual9Ys6mMvN4JPy/exec';
        
        // Bi·∫øn l∆∞u tr·ªØ hi·ªáu su·∫•t
        const performanceData = {
            configA: [],
            configB: [],
            append: [],
            chartData: []
        };
        
        // Kh·ªüi t·∫°o callback global
        window.jsonpCallback = null;
        
        // Hi·ªÉn th·ªã tr·∫°ng th√°i
        function showStatus(message, type = 'info') {
            const statusEl = document.getElementById('status');
            statusEl.textContent = message;
            statusEl.className = 'status ' + type;
        }
        
        // Th√™m log entry
        function addLogEntry(action, message, duration = null, success = true) {
            const logEntries = document.getElementById('logEntries');
            const time = new Date().toLocaleTimeString();
            
            const entry = document.createElement('div');
            entry.className = 'log-entry';
            
            let logText = `<span class="log-time">[${time}]</span> `;
            logText += `<span class="log-action">${action}:</span> ${message}`;
            
            if (duration !== null) {
                logText += ` <span class="log-duration">(${duration.toFixed(2)}s)</span>`;
            }
            
            if (!success) {
                entry.classList.add('log-error');
            } else if (duration !== null) {
                entry.classList.add('log-success');
            }
            
            entry.innerHTML = logText;
            logEntries.insertBefore(entry, logEntries.firstChild);
            
            // Gi·ªõi h·∫°n s·ªë l∆∞·ª£ng log entries
            if (logEntries.children.length > 20) {
                logEntries.removeChild(logEntries.lastChild);
            }
        }
        
        // C·∫≠p nh·∫≠t timeline
        function updateTimeline(step) {
            const steps = ['timelineStart', 'timelineRequest', 'timelineProcessing', 'timelineResponse', 'timelineComplete'];
            
            // Reset all steps
            steps.forEach(stepId => {
                const element = document.getElementById(stepId);
                element.classList.remove('active');
            });
            
            // Activate steps up to current
            for (let i = 0; i <= step; i++) {
                const element = document.getElementById(steps[i]);
                if (element) {
                    element.classList.add('active');
                    
                    // Add slight delay for animation effect
                    setTimeout(() => {
                        element.style.transform = 'scale(1.2)';
                        setTimeout(() => {
                            element.style.transform = 'scale(1)';
                        }, 200);
                    }, i * 100);
                }
            }
        }
        
        // C·∫≠p nh·∫≠t bi·ªÉu ƒë·ªì
        function updateChart() {
            const container = document.getElementById('chartContainer');
            container.innerHTML = '';
            
            // Get last 10 data points
            const recentData = performanceData.chartData.slice(-10);
            
            // Find max duration for scaling
            const maxDuration = Math.max(...recentData.map(d => d.duration), 1);
            
            // Create bars
            recentData.forEach((data, index) => {
                const barHeight = (data.duration / maxDuration) * 80;
                const barLeft = (index * 35) + 10;
                
                const bar = document.createElement('div');
                bar.className = 'chart-bar';
                bar.style.height = `${barHeight}px`;
                bar.style.left = `${barLeft}px`;
                bar.title = `${data.action}: ${data.duration.toFixed(2)}s`;
                
                const label = document.createElement('div');
                label.className = 'chart-label';
                label.style.left = `${barLeft}px`;
                label.textContent = data.action;
                
                container.appendChild(bar);
                container.appendChild(label);
            });
        }
        
        // T√≠nh to√°n v√† hi·ªÉn th·ªã th·ªëng k√™
        function updatePerformanceStats(action, duration) {
            // L∆∞u d·ªØ li·ªáu
            performanceData[action].push(duration);
            performanceData.chartData.push({
                action: action,
                duration: duration,
                timestamp: new Date()
            });
            
            // C·∫≠p nh·∫≠t gi√° tr·ªã
            const elementId = action === 'configA' ? 'configATime' : 
                             action === 'configB' ? 'configBTime' : 'appendTime';
            const detailId = action === 'configA' ? 'configADetail' : 
                            action === 'configB' ? 'configBDetail' : 'appendDetail';
            
            document.getElementById(elementId).textContent = duration.toFixed(2);
            document.getElementById(detailId).textContent = 
                `${performanceData[action].length} l∆∞·ª£t ƒëo | Min: ${Math.min(...performanceData[action]).toFixed(2)}s | Max: ${Math.max(...performanceData[action]).toFixed(2)}s`;
            
            // T√≠nh trung b√¨nh
            const allTimes = [...performanceData.configA, ...performanceData.configB, ...performanceData.append];
            if (allTimes.length > 0) {
                const avg = allTimes.reduce((a, b) => a + b, 0) / allTimes.length;
                document.getElementById('avgTime').textContent = avg.toFixed(2);
                document.getElementById('avgDetail').textContent = `${allTimes.length} l∆∞·ª£t ƒëo t·ªïng`;
            }
            
            // C·∫≠p nh·∫≠t bi·ªÉu ƒë·ªì
            updateChart();
        }
        
        // T·∫°o script tag cho JSONP
        function createJsonpScript(url, callbackName) {
            return new Promise((resolve, reject) => {
                // X√≥a callback c≈© n·∫øu c√≥
                if (window[callbackName]) {
                    delete window[callbackName];
                }
                
                // T·∫°o callback function m·ªõi
                window[callbackName] = function(data) {
                    // X√≥a script tag sau khi d√πng
                    const oldScript = document.getElementById('jsonp-script');
                    if (oldScript) {
                        oldScript.remove();
                    }
                    
                    // X√≥a callback
                    delete window[callbackName];
                    
                    resolve(data);
                };
                
                // T·∫°o v√† th√™m script tag
                const script = document.createElement('script');
                script.id = 'jsonp-script';
                script.src = url;
                script.onerror = reject;
                document.body.appendChild(script);
                
                // Timeout sau 30 gi√¢y
                setTimeout(() => {
                    const scriptEl = document.getElementById('jsonp-script');
                    if (scriptEl) {
                        scriptEl.remove();
                        reject(new Error('Request timeout (30s)'));
                    }
                }, 30000);
            });
        }
        
        // L·∫•y d·ªØ li·ªáu t·ª´ backend
        async function fetchData(action) {
            const startTime = performance.now();
            updateTimeline(1);
            showStatus('‚è≥ ƒêang g·ª≠i request l·∫•y d·ªØ li·ªáu...', 'loading');
            addLogEntry(`GET ${action}`, 'B·∫Øt ƒë·∫ßu g·ª≠i request');
            
            try {
                updateTimeline(2);
                addLogEntry(`GET ${action}`, 'Request ƒë√£ g·ª≠i, ƒëang x·ª≠ l√Ω server');
                
                // T·∫°o URL v·ªõi tham s·ªë
                const url = `${scriptUrl}?action=${action}&callback=jsonpCallback&t=${Date.now()}`;
                
                // G·ªçi API b·∫±ng JSONP
                const data = await createJsonpScript(url, 'jsonpCallback');
                
                const receiveTime = performance.now();
                updateTimeline(3);
                addLogEntry(`GET ${action}`, 'ƒê√£ nh·∫≠n response t·ª´ server');
                
                if (data.error) {
                    updateTimeline(4);
                    const totalTime = (receiveTime - startTime) / 1000;
                    showStatus(`‚ùå L·ªói: ${data.error} (${totalTime.toFixed(2)}s)`, 'error');
                    addLogEntry(`GET ${action}`, `L·ªói: ${data.error}`, totalTime, false);
                    updatePerformanceStats(`config${action}`, totalTime);
                    return;
                }
                
                // Hi·ªÉn th·ªã k·∫øt qu·∫£
                updateTimeline(4);
                displayResults(data);
                
                const displayTime = performance.now();
                const totalTime = (displayTime - startTime) / 1000;
                const serverTime = (receiveTime - startTime) / 1000;
                const renderTime = (displayTime - receiveTime) / 1000;
                
                updateTimeline(5);
                showStatus(`‚úÖ ƒê√£ t·∫£i ${data.data.length} m·ª•c t·ª´ c·ªôt ${action} (T·ªïng: ${totalTime.toFixed(2)}s)`, 'success');
                addLogEntry(`GET ${action}`, `Th√†nh c√¥ng! Server: ${serverTime.toFixed(2)}s, Render: ${renderTime.toFixed(2)}s`, totalTime);
                updatePerformanceStats(`config${action}`, totalTime);
                
            } catch (error) {
                const totalTime = (performance.now() - startTime) / 1000;
                showStatus(`‚ùå L·ªói k·∫øt n·ªëi: ${error.message} (${totalTime.toFixed(2)}s)`, 'error');
                addLogEntry(`GET ${action}`, `L·ªói k·∫øt n·ªëi: ${error.message}`, totalTime, false);
                updatePerformanceStats(`config${action}`, totalTime);
                console.error('Fetch error:', error);
            }
        }
        
        // Th√™m d·ªØ li·ªáu m·ªõi
        async function appendData() {
            const startTime = performance.now();
            updateTimeline(1);
            showStatus('‚è≥ ƒêang g·ª≠i request ghi d·ªØ li·ªáu...', 'loading');
            addLogEntry('APPEND', 'B·∫Øt ƒë·∫ßu g·ª≠i request ghi log');
            
            try {
                updateTimeline(2);
                addLogEntry('APPEND', 'Request ƒë√£ g·ª≠i, ƒëang x·ª≠ l√Ω server');
                
                const timestamp = new Date().toLocaleTimeString();
                const url = `${scriptUrl}?action=appendData&value=Data+added+at+${encodeURIComponent(timestamp)}&callback=jsonpCallback&t=${Date.now()}`;
                
                const data = await createJsonpScript(url, 'jsonpCallback');
                
                const receiveTime = performance.now();
                updateTimeline(3);
                addLogEntry('APPEND', 'ƒê√£ nh·∫≠n x√°c nh·∫≠n t·ª´ server');
                
                if (data.error) {
                    updateTimeline(4);
                    const totalTime = (receiveTime - startTime) / 1000;
                    showStatus(`‚ùå L·ªói: ${data.error} (${totalTime.toFixed(2)}s)`, 'error');
                    addLogEntry('APPEND', `L·ªói: ${data.error}`, totalTime, false);
                    updatePerformanceStats('append', totalTime);
                    return;
                }
                
                updateTimeline(4);
                const displayTime = performance.now();
                const totalTime = (displayTime - startTime) / 1000;
                const serverTime = (receiveTime - startTime) / 1000;
                const confirmTime = (displayTime - receiveTime) / 1000;
                
                updateTimeline(5);
                showStatus(`‚úÖ ${data.message} (T·ªïng: ${totalTime.toFixed(2)}s)`, 'success');
                addLogEntry('APPEND', `Ghi th√†nh c√¥ng! Server: ${serverTime.toFixed(2)}s, X√°c nh·∫≠n: ${confirmTime.toFixed(2)}s`, totalTime);
                updatePerformanceStats('append', totalTime);
                
                // T·∫£i l·∫°i d·ªØ li·ªáu ƒë·ªÉ c·∫≠p nh·∫≠t
                fetchData('A');
                
            } catch (error) {
                const totalTime = (performance.now() - startTime) / 1000;
                showStatus(`‚ùå L·ªói: ${error.message} (${totalTime.toFixed(2)}s)`, 'error');
                addLogEntry('APPEND', `L·ªói: ${error.message}`, totalTime, false);
                updatePerformanceStats('append', totalTime);
            }
        }
        
        // Hi·ªÉn th·ªã d·ªØ li·ªáu
        function displayResults(response) {
            const resultsEl = document.getElementById('results');
            const actionBadge = document.getElementById('actionBadge');
            
            // C·∫≠p nh·∫≠t badge
            actionBadge.textContent = `C·ªôt ${response.action}`;
            actionBadge.style.background = response.action === 'A' ? '#667eea' : '#f5576c';
            
            // X√≥a n·ªôi dung c≈©
            resultsEl.innerHTML = '';
            
            // Ki·ªÉm tra n·∫øu kh√¥ng c√≥ d·ªØ li·ªáu
            if (!response.data || response.data.length === 0) {
                const noData = document.createElement('li');
                noData.className = 'no-data';
                noData.textContent = 'Kh√¥ng c√≥ d·ªØ li·ªáu trong c·ªôt n√†y';
                resultsEl.appendChild(noData);
                return;
            }
            
            // Th√™m t·ª´ng m·ª•c d·ªØ li·ªáu
            response.data.forEach((item, index) => {
                const li = document.createElement('li');
                li.className = 'data-item';
                
                const indexSpan = document.createElement('span');
                indexSpan.className = 'data-index';
                indexSpan.textContent = index + 1;
                
                const contentSpan = document.createElement('span');
                contentSpan.textContent = item;
                
                li.appendChild(indexSpan);
                li.appendChild(contentSpan);
                resultsEl.appendChild(li);
            });
            
            // Th√™m timestamp v√† th√¥ng tin hi·ªáu su·∫•t
            const infoDiv = document.createElement('div');
            infoDiv.style.cssText = 'text-align: right; font-size: 0.8em; color: #666; margin-top: 10px; padding-top: 10px; border-top: 1px solid #eee;';
            infoDiv.textContent = `C·∫≠p nh·∫≠t: ${new Date().toLocaleTimeString()} | ${response.data.length} m·ª•c`;
            resultsEl.appendChild(infoDiv);
        }
        
        // H√†m kh·ªüi t·∫°o
        function init() {
            addLogEntry('SYSTEM', 'H·ªá th·ªëng ƒë√£ s·∫µn s√†ng');
            console.log('Performance Monitor loaded successfully');
            console.log('Script URL:', scriptUrl);
            
            // Kh·ªüi t·∫°o timeline
            setTimeout(() => updateTimeline(0), 500);
            
            // T·∫°o d·ªØ li·ªáu bi·ªÉu ƒë·ªì m·∫´u
            performanceData.chartData = [
                { action: 'A', duration: 0.5, timestamp: new Date() },
                { action: 'B', duration: 0.7, timestamp: new Date() },
                { action: 'APPEND', duration: 1.2, timestamp: new Date() }
            ];
            updateChart();
        }
        
        // Kh·ªüi ch·∫°y khi trang t·∫£i xong
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
