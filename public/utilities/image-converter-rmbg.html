<!DOCTYPE html>
<html lang="vi-VN">
<head>
    <!-- === META FOUNDATION === -->
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, minimum-scale=1.0">

    <!-- === PRIMARY META - T·ªêI ∆ØU H√ÄNG ƒê·∫¶U === -->
    <title>C√¥ng C·ª• N√©n, X√≥a N·ªÅn & T·ªëi ∆Øu H√≥a ·∫¢nh | Mi·ªÖn Ph√≠ - LAZINET</title>
    <meta name="description" content="üéØ X√≥a n·ªÅn ·∫£nh t·ª± ƒë·ªông, chuy·ªÉn ƒë·ªïi sang WebP mi·ªÖn ph√≠ v·ªõi t√πy ch·ªânh resize, l√†m ƒë·∫πp. H·ªó tr·ª£ batch JPG, PNG, GIF... C√¥ng c·ª• n√©n v√† x·ª≠ l√Ω ·∫£nh online hi·ªáu qu·∫£.">
    <meta name="keywords" content="x√≥a n·ªÅn ·∫£nh, remove background, chuy·ªÉn webp, n√©n ·∫£nh webp, convert to webp, batch webp converter, resize ·∫£nh, l√†m ƒë·∫πp ·∫£nh, c√¥ng c·ª• webp online, n√©n ·∫£nh mi·ªÖn ph√≠, webp maker, t·ªëi ∆∞u h√≥a ·∫£nh">

    <!-- === AUTHORITY & OWNERSHIP === -->
    <meta name="author" content="LAZINET - C√¥ng Ty C√¥ng Ngh·ªá H√†ng ƒê·∫ßu Vi·ªát Nam">
    <meta name="publisher" content="LAZINET Technologies">
    <meta name="copyright" content="LAZINET ¬© 2024">
    <meta name="designer" content="LAZINET Design Team">
    <meta name="reply-to" content="email@lazinet.com">

    <!-- === ROBOTS & CRAWLING - T·ªêI ∆ØU CRAWL === -->
    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">
    <meta name="googlebot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
    <meta name="bingbot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
    <meta name="slurp" content="index, follow, max-image-preview:large">
    <meta name="msnbot" content="index, follow, max-image-preview:large">
    <meta name="alexabot" content="index, follow">

    <!-- === CANONICAL & LANGUAGE === -->
    <link rel="canonical" href="https://lazinet.com/image-converter.html">
    <link rel="alternate" hreflang="vi-VN" href="https://lazinet.com/image-converter.html">
    <link rel="alternate" hreflang="vi" href="https://lazinet.com/image-converter.html">
    <link rel="alternate" hreflang="en" href="https://lazinet.com/en/image-converter.html">
    <link rel="alternate" hreflang="x-default" href="https://lazinet.com/image-converter.html">

    <!-- === SITEMAP & SEO LINKS === -->
    <link rel="sitemap" type="application/xml" title="Sitemap" href="https://lazinet.com/sitemap.xml">
    <link rel="author" href="https://lazinet.com/humans.txt">

    <!-- === FAVICON & APP ICONS - T·ªêI ∆ØU PWA === -->
    <link rel="icon" type="image/x-icon" href="../assets/img/logo-lazinet/lazinet_LogoOnly.ico">
    <link rel="icon" type="image/png" sizes="192x192" href="../assets/img/logo-lazinet/lazinet_LogoOnly-192x192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="../assets/img/logo-lazinet/lazinet_LogoOnly-512x512.png">
    <link rel="apple-touch-icon" sizes="180x180" href="../assets/img/logo-lazinet/lazinet_LogoOnly-180x180.png">
    <link rel="apple-touch-icon" sizes="152x152" href="../assets/img/logo-lazinet/lazinet_LogoOnly-152x152.png">
    <link rel="apple-touch-icon" sizes="120x120" href="../assets/img/logo-lazinet/lazinet_LogoOnly-120x120.png">
    <link rel="apple-touch-icon" sizes="76x76" href="../assets/img/logo-lazinet/lazinet_LogoOnly-76x76.png">
    <link rel="mask-icon" href="../assets/img/logo-lazinet/lazinet_LogoOnly.svg" color="#0052FF">

    <!-- === OPEN GRAPH - T·ªêI ∆ØU SOCIAL SHARING === -->
    <meta property="og:title" content="X√≥a N·ªÅn ·∫¢nh & Chuy·ªÉn ƒê·ªïi WebP Mi·ªÖn Ph√≠ | C√¥ng C·ª• N√©n ·∫¢nh - LAZINET">
    <meta property="og:description" content="X√≥a n·ªÅn ·∫£nh t·ª± ƒë·ªông, chuy·ªÉn ƒë·ªïi sang WebP mi·ªÖn ph√≠ v·ªõi t√πy ch·ªânh resize, l√†m ƒë·∫πp. H·ªó tr·ª£ batch JPG, PNG, GIF... C√¥ng c·ª• x·ª≠ l√Ω ·∫£nh online t·ªët nh·∫•t Vi·ªát Nam 2024.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://lazinet.com/image-converter.html">
    <meta property="og:image" content="https://lazinet.com/assets/img/social/image-converter-og-1200x630.jpg">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:image:alt" content="Giao di·ªán c√¥ng c·ª• x√≥a n·ªÅn v√† chuy·ªÉn ƒë·ªïi WebP chuy√™n nghi·ªáp c·ªßa LAZINET">
    <meta property="og:site_name" content="LAZINET - C√¥ng Ty C√¥ng Ngh·ªá H√†ng ƒê·∫ßu">
    <meta property="og:locale" content="vi_VN">
    <meta property="og:locale:alternate" content="en_US">
    <meta property="og:article:author" content="LAZINET">
    <meta property="og:article:publisher" content="https://www.facebook.com/lazinet.vn">

    <!-- === TWITTER CARD - T·ªêI ∆ØU TWITTER === -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@lazinet_vn">
    <meta name="twitter:creator" content="@lazinet_tech">
    <meta name="twitter:title" content="X√≥a N·ªÅn ·∫¢nh & Chuy·ªÉn ƒê·ªïi WebP Mi·ªÖn Ph√≠ | C√¥ng C·ª• N√©n ·∫¢nh - LAZINET">
    <meta name="twitter:description" content="X√≥a n·ªÅn ·∫£nh t·ª± ƒë·ªông, chuy·ªÉn ƒë·ªïi sang WebP mi·ªÖn ph√≠ v·ªõi t√πy ch·ªânh resize, l√†m ƒë·∫πp. H·ªó tr·ª£ batch JPG, PNG, GIF... C√¥ng c·ª• x·ª≠ l√Ω ·∫£nh online t·ªët nh·∫•t Vi·ªát Nam 2024.">
    <meta name="twitter:image" content="https://lazinet.com/assets/img/social/image-converter-twitter-1200x600.jpg">
    <meta name="twitter:image:alt" content="C√¥ng c·ª• x√≥a n·ªÅn v√† chuy·ªÉn ƒë·ªïi WebP c·ªßa LAZINET">
    <meta name="twitter:label1" content="Th·ªùi gian ƒë·ªçc">
    <meta name="twitter:data1" content="2 ph√∫t">
    <meta name="twitter:label2" content="Lo·∫°i c√¥ng c·ª•">
    <meta name="twitter:data2" content="X√≥a n·ªÅn & WebP mi·ªÖn ph√≠">

    <!-- === WHATSAPP SPECIFIC === -->
    <meta property="og:image:type" content="image/jpeg">
    <meta property="og:image:secure_url" content="https://lazinet.com/assets/img/social/image-converter-whatsapp-300x300.jpg">

    <!-- === LINKEDIN OPTIMIZATION === -->
    <meta property="og:image:linkedin" content="https://lazinet.com/assets/img/social/image-converter-linkedin-1200x627.jpg">

    <!-- === PINTEREST === -->
    <meta name="pinterest" content="nopin" description="C√¥ng c·ª• x√≥a n·ªÅn v√† chuy·ªÉn ƒë·ªïi WebP chuy√™n nghi·ªáp">

    <!-- === MOBILE & PWA OPTIMIZATION === -->
    <meta name="theme-color" content="#0052FF">
    <meta name="msapplication-TileColor" content="#0052FF">
    <meta name="msapplication-TileImage" content="../assets/img/logo-lazinet/lazinet_LogoOnly-144x144.png">
    <meta name="msapplication-config" content="../browserconfig.xml">
    <meta name="apple-mobile-web-app-title" content="LAZINET Image Tools">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="application-name" content="LAZINET Image Converter">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no, date=no, address=no, email=no">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">

    <!-- === SCHEMA.ORG STRUCTURED DATA - C·∫¢I THI·ªÜN RICH SNIPPETS === -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "SoftwareApplication",
        "name": "LAZINET Image Converter & Background Remover",
        "applicationCategory": "BusinessApplication",
        "operatingSystem": "Web",
        "description": "C√¥ng c·ª• x√≥a n·ªÅn ·∫£nh t·ª± ƒë·ªông v√† chuy·ªÉn ƒë·ªïi ·∫£nh sang WebP mi·ªÖn ph√≠ v·ªõi t√≠nh nƒÉng resize, l√†m ƒë·∫πp, h·ªó tr·ª£ batch v√† nhi·ªÅu ƒë·ªãnh d·∫°ng ƒë·∫ßu v√†o.",
        "url": "https://lazinet.com/image-converter.html",
        "image": "https://lazinet.com/assets/img/social/image-converter-schema-1200x630.jpg",
        "author": {
            "@type": "Organization",
            "name": "LAZINET Technologies",
            "url": "https://lazinet.com",
            "logo": "https://lazinet.com/assets/img/logo-lazinet/lazinet_LogoFullv2.png"
        },
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "VND",
            "availability": "https://schema.org/InStock",
            "url": "https://lazinet.com/image-converter.html"
        },
        "aggregateRating": {
            "@type": "AggregateRating",
            "ratingValue": "4.9",
            "ratingCount": "950",
            "bestRating": "5",
            "worstRating": "1"
        },
        "featureList": [
            "X√≥a n·ªÅn ·∫£nh t·ª± ƒë·ªông",
            "Chuy·ªÉn ƒë·ªïi batch mi·ªÖn ph√≠",
            "Resize v√† l√†m ƒë·∫πp ·∫£nh",
            "H·ªó tr·ª£ JPG, PNG, GIF, TIFF",
            "Ch·∫•t l∆∞·ª£ng cao WebP/AVIF",
            "Kh√¥ng gi·ªõi h·∫°n k√≠ch th∆∞·ªõc"
        ],
        "softwareVersion": "2.0",
        "datePublished": "2024-01-20",
        "dateModified": "2024-12-15"
    }
    </script>

    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "BreadcrumbList",
        "itemListElement": [
            {
                "@type": "ListItem",
                "position": 1,
                "name": "Trang ch·ªß",
                "item": "https://lazinet.com"
            },
            {
                "@type": "ListItem",
                "position": 2,
                "name": "C√¥ng c·ª• mi·ªÖn ph√≠",
                "item": "https://lazinet.com/utilities.html"
            },
            {
                "@type": "ListItem",
                "position": 3,
                "name": "X√≥a N·ªÅn & Chuy·ªÉn ƒê·ªïi ·∫¢nh",
                "item": "https://lazinet.com/image-converter.html"
            }
        ]
    }
    </script>

    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebPage",
        "name": "X√≥a N·ªÅn ·∫¢nh & Chuy·ªÉn ƒê·ªïi WebP Mi·ªÖn Ph√≠ | LAZINET",
        "description": "C√¥ng c·ª• x√≥a n·ªÅn ·∫£nh t·ª± ƒë·ªông v√† chuy·ªÉn ƒë·ªïi ·∫£nh chuy√™n nghi·ªáp v·ªõi t√πy ch·ªânh ƒë·∫ßy ƒë·ªß",
        "url": "https://lazinet.com/image-converter.html",
        "primaryImageOfPage": {
            "@type": "ImageObject",
            "url": "https://lazinet.com/assets/img/social/image-converter-og-1200x630.jpg",
            "width": 1200,
            "height": 630
        },
        "isPartOf": {
            "@type": "WebSite",
            "name": "LAZINET",
            "url": "https://lazinet.com",
            "potentialAction": {
                "@type": "SearchAction",
                "target": "https://lazinet.com/search?q={search_term_string}",
                "query-input": "required name=search_term_string"
            }
        },
        "speakable": {
            "@type": "SpeakableSpecification",
            "cssSelector": [".main-content", ".tool-description"]
        },
        "inLanguage": "vi-VN"
    }
    </script>

    <!-- === ADDITIONAL SEO ENHANCEMENTS === -->
    <meta name="google-site-verification" content="YOUR_GOOGLE_VERIFICATION_CODE">
    <meta name="yandex-verification" content="YOUR_YANDEX_VERIFICATION">
    <meta name="baidu-site-verification" content="YOUR_BAIDU_VERIFICATION">
    <meta name="facebook-domain-verification" content="YOUR_FACEBOOK_VERIFICATION">

    <!-- === PERFORMANCE & CACHING HINTS === -->
    <meta http-equiv="Cache-Control" content="max-age=31536000, public">
    <meta http-equiv="Expires" content="Mon, 10 Dec 2025 00:00:00 GMT">
    <meta http-equiv="Pragma" content="public">
    <meta http-equiv="Content-Language" content="vi">

    <!-- === PRELOAD CRITICAL RESOURCES === -->
    <link rel="preload" href="../assets/img/logo-lazinet/lazinet_LogoFullv2.png" as="image">
    
    <!-- === CSS FILES from LAZINET === -->
    <link rel="preconnect" href="https://fonts.googleapis.com/">
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Geist:wght@300..700&family=Instrument+Sans:wght@400..700&display=swap">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Sora:wght@100..800&amp;display=swap">
    <link rel="stylesheet" href="../assets/css/bootstrap.min.css" media="screen">
    <link rel="stylesheet" href="../assets/css/slicknav.min.css">
    <link rel="stylesheet" href="../assets/css/swiper-bundle.min.css">
    <link rel="stylesheet" href="../assets/css/all.min.css" media="screen">
    <link rel="stylesheet" href="../assets/css/animate.css">
    <link rel="stylesheet" href="../assets/css/magnific-popup.css">
    <link rel="stylesheet" href="../assets/css/mousecursor.css">
    <link rel="stylesheet" href="../assets/css/custom.css" media="screen">
    <link rel="stylesheet" href="../assets/css/lazinet.css">
    <style>
        /* Global Variables from LAZINET custom.css */
        :root {
            --primary-color: #FFFFFF;
            --secondary-color: #FFFFFF0A;
            --orange-main: #ff5000;
            --orange-light: #FFbbbb;
            --blue-main: blue;
            --blue-light: #ccccff;
            --text-color: #FFFFFF;
            --accent-color: #3F82FB;
            --accent-secondary-color: #0F2453;
            --bg-color: #0F162C;
            --white-color: #FFFFFF;
            --black-color: #000000;
            --divider-color: #FFFFFF1A;
            --error-color: rgb(230, 87, 87);
            --default-font: "Instrument Sans", "Geist", "Inter", system-ui, sans-serif;
            --dropdown-bg: #e0f2fe; /* Light blue for dropdown options */
            --success-color: #4CAF50;
            --warning-color: #FF9800;
            --info-color: #2196F3;
            --transparent-color: #00FFFFFF;
            --magenta-main: #FF00FF;
            --green-main: #00FF00;
        }

        /* General Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: var(--default-font);
        }

        body {
            background: linear-gradient(135deg, var(--accent-secondary-color) 0%, var(--accent-color) 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            color: var(--text-color);
            overflow-x: hidden;
        }

        .container {
            background: var(--bg-color);
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            padding: 30px;
            width: 100%;
            max-width: 1200px;
            border: 1px solid var(--divider-color);
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .logo {
            height: 80px;
            filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.2));
        }

        h1 {
            color: var(--primary-color);
            margin: 15px 0;
            font-size: 2.2em;
            text-align: center;
        }

        .subtitle {
            text-align: center;
            color: var(--text-color);
            opacity: 0.8;
            margin-bottom: 30px;
            font-size: 1.1em;
        }

        .main-content {
            display: grid;
            grid-template-columns: 400px 1fr;
            gap: 30px;
        }

        /* === CONTROL PANEL STYLES === */
        .control-panel {
            background: var(--secondary-color);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid var(--divider-color);
            height: fit-content;
        }

        .panel-section {
            margin-bottom: 25px;
        }

        .section-title {
            font-size: 1.1em;
            font-weight: 600;
            margin-bottom: 15px;
            color: var(--primary-color);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .section-title i {
            font-size: 1.2em;
        }

        /* === UPLOAD SECTION === */
        .upload-area {
            border: 3px dashed var(--divider-color);
            border-radius: 12px;
            padding: 30px 20px;
            text-align: center;
            transition: all 0.3s;
            cursor: pointer;
            background: rgba(255, 255, 255, 0.05);
        }

        .upload-area:hover, .upload-area.dragover {
            border-color: var(--accent-color);
            background: rgba(63, 130, 251, 0.1);
        }

        .upload-icon {
            font-size: 48px;
            margin: 25px;
            opacity: 0.8;
        }

        .upload-text {
            font-size: 1.1em;
            margin-bottom: 10px;
            color: var(--primary-color);
        }

        .upload-hint {
            font-size: 0.9em;
            opacity: 0.7;
            margin-bottom: 20px;
        }

        .upload-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
        }

        /* === BUTTON STYLES === */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 12px 20px;
            border: none;
            border-radius: 10px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            text-decoration: none;
            white-space: nowrap;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--accent-secondary-color), var(--accent-color));
            color: var(--white-color);
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, var(--accent-color), var(--accent-secondary-color));
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(63, 130, 251, 0.3);
        }

        .btn-secondary {
            background: var(--secondary-color);
            color: var(--text-color);
            border: 2px solid var(--divider-color);
        }

        .btn-secondary:hover {
            background: var(--accent-secondary-color);
            transform: translateY(-2px);
        }

        .btn-large {
            padding: 15px 30px;
            font-size: 16px;
        }

        /* === FORM CONTROLS === */
        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            font-size: 0.95em;
            color: var(--text-color);
        }

        input[type="range"] {
            width: 100%;
            height: 8px;
            background: var(--divider-color);
            border-radius: 4px;
            outline: none;
            -webkit-appearance: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            background: var(--orange-main);
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .range-value {
            display: inline-block;
            background: var(--accent-color);
            color: white;
            padding: 2px 10px;
            border-radius: 10px;
            font-size: 0.9em;
            font-weight: 600;
            margin-left: 10px;
        }

        select, input[type="number"] {
            width: 100%;
            padding: 12px 15px;
            background: rgba(255, 255, 255, 0.08);
            border: 2px solid var(--divider-color);
            border-radius: 10px;
            color: var(--text-color);
            font-size: 14px;
            transition: all 0.3s;
            backdrop-filter: blur(10px);
        }

        /* === FIXED DROPDOWN BACKGROUND === */
        select {
            background: rgba(255, 255, 255, 0.08) !important;
        }

        select option {
            background: var(--dropdown-bg) !important;
            color: var(--black-color) !important;
            padding: 10px !important;
            font-size: 14px !important;
        }

        select option:hover {
            background: var(--accent-color) !important;
            color: var(--white-color) !important;
        }

        select:focus, input[type="number"]:focus {
            outline: none;
            border-color: var(--accent-color);
            box-shadow: 0 0 0 3px rgba(63, 130, 251, 0.1);
        }

        /* === RADIO GROUP === */
        .radio-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .radio-option {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            border: 2px solid transparent;
            cursor: pointer;
            transition: all 0.3s;
        }

        .radio-option:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: var(--divider-color);
        }

        .radio-option.selected {
            background: rgba(63, 130, 251, 0.15);
            border-color: var(--accent-color);
        }

        .radio-option input[type="radio"] {
            margin: 0;
        }

        /* === IMAGE PREVIEW SECTION === */
        .preview-section {
            background: var(--secondary-color);
            border-radius: 15px;
            padding: 20px;
            border: 1px solid var(--divider-color);
            min-height: 400px;
            overflow-y: auto;
            height: auto;
        }

        /* Tr√™n m√†n h√¨nh l·ªõn (2 c·ªôt ngang) */
        @media (min-width: 993px) {
            .main-content {
                grid-template-columns: 400px 1fr;
                gap: 30px;
                align-items: stretch;
            }
            
            .control-panel {
                height: fit-content;
                max-height: 100%;
            }
            
            .preview-section {
                height: 100%;
                display: flex;
                flex-direction: column;
            }
            
            .preview-grid {
                flex: 1;
                min-height: 0;
            }
        }

        /* Tr√™n m√†n h√¨nh nh·ªè (1 c·ªôt d·ªçc) */
        @media (max-width: 992px) {
            .main-content {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .control-panel {
                height: auto;
            }
            
            .preview-section {
                height: auto;
                min-height: 300px;
                max-height: none;
            }
        }

        /* T·ªëi ∆∞u responsive */
        @media (max-width: 768px) {
            .preview-section {
                min-height: 250px;
                padding: 15px;
            }
        }

        @media (max-width: 480px) {
            .preview-section {
                min-height: 200px;
                padding: 12px;
            }
        }

        .preview-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--divider-color);
        }

        .preview-title {
            font-weight: 600;
            font-size: 1.2em;
            color: var(--primary-color);
        }

        .preview-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }

        /* === IMAGE COMPARISON CARD === */
        .image-comparison-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 15px;
            border: 1px solid var(--divider-color);
        }

        .comparison-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--divider-color);
        }

        .file-name {
            font-weight: 600;
            font-size: 0.95em;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .comparison-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .image-container {
            position: relative;
            width: 100%;
            height: 150px;
            border-radius: 8px;
            overflow: hidden;
            background: rgba(0, 0, 0, 0.2);
        }

        /* N·ªÅn trong su·ªët pattern */
        .image-container.transparent-bg {
            background-image: 
                linear-gradient(45deg, #ccc 25%, transparent 25%), 
                linear-gradient(-45deg, #ccc 25%, transparent 25%),
                linear-gradient(45deg, transparent 75%, #ccc 75%),
                linear-gradient(-45deg, transparent 75%, #ccc 75%);
            background-size: 20px 20px;
            background-position: 0 0, 0 10px, 10px -10px, -10px 0px;
        }

        .image-preview {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .image-info {
            position: absolute;
            top: 5px;
            left: 5px;
            right: 5px;
            bottom: 5px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            padding: 8px;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 6px;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .image-container:hover .image-info {
            opacity: 1;
        }

        .info-top {
            display: flex;
            justify-content: space-between;
            font-size: 11px;
            font-weight: 600;
        }

        .info-bottom {
            display: flex;
            justify-content: space-between;
            font-size: 11px;
        }

        .compression-ratio {
            font-weight: bold;
            color: var(--success-color);
        }

        /* === PROGRESS BAR === */
        .progress-container {
            margin: 20px 0;
        }

        .progress-bar {
            height: 8px;
            background: var(--divider-color);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 10px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--orange-main), var(--blue-main));
            width: 0%;
            transition: width 0.3s;
        }

        .progress-text {
            display: flex;
            justify-content: space-between;
            font-size: 0.9em;
            opacity: 0.8;
        }

        /* === STATISTICS PANEL === */
        .stats-panel {
            background: linear-gradient(135deg, var(--accent-secondary-color), var(--accent-color));
            border-radius: 15px;
            padding: 20px;
            margin-top: 30px;
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 15px;
        }

        .stat-item {
            text-align: center;
            padding: 15px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            backdrop-filter: blur(10px);
        }

        .stat-value {
            font-size: 1.8em;
            font-weight: 700;
            margin-bottom: 5px;
            color: var(--white-color);
        }

        .stat-label {
            font-size: 0.85em;
            opacity: 0.9;
        }

        /* === CONTROLS === */
        .controls {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 25px;
            margin-bottom: 25px;
            padding-top: 25px;
            border-top: 1px solid var(--divider-color);
            justify-content: center;
        }

        .btn-process {
            flex: 1;
            min-width: 200px;
            max-width: 300px;
            padding: 16px 30px;
            font-size: 16px;
            font-weight: 600;
        }

        /* === FOOTER === */
        footer {
            text-align: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid var(--divider-color);
            color: var(--text-color);
            opacity: 0.7;
            font-size: 0.9em;
        }

        /* === ERROR MESSAGE === */
        .error {
            color: var(--error-color);
            font-size: 0.9em;
            margin-top: 5px;
            display: none;
        }

        .loading {
            color: var(--accent-color);
            font-style: italic;
            text-align: center;
        }

        /* === NEW: BACKGROUND REMOVAL OPTIONS === */
        .bg-removal-options {
            margin-top: 10px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            border-left: 3px solid var(--magenta-main);
        }

        .bg-option-row {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }

        .bg-checkbox-label {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            font-size: 0.95em;
            flex: 1;
        }

        .bg-color-picker {
            width: 30px;
            height: 30px;
            border-radius: 6px;
            border: 2px solid var(--divider-color);
            cursor: pointer;
            background: var(--white-color);
        }

        .bg-intensity-slider {
            flex: 1;
        }

        .bg-intensity-value {
            min-width: 40px;
            text-align: center;
            font-weight: 600;
            color: var(--magenta-main);
        }

        /* === NEW: PROCESSING STATUS === */
        .processing-status {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 15px;
            background: rgba(63, 130, 251, 0.1);
            border-radius: 8px;
            margin-top: 10px;
            font-size: 0.9em;
        }

        .status-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: var(--info-color);
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0% { opacity: 0.5; }
            50% { opacity: 1; }
            100% { opacity: 0.5; }
        }

        /* === RESPONSIVE DESIGN === */
        @media (max-width: 992px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .control-panel {
                position: sticky;
                top: 20px;
                z-index: 100;
            }
            
            .stats-panel {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }
            
            h1 {
                font-size: 1.8em;
            }
            
            .preview-grid {
                grid-template-columns: 1fr;
            }
            
            .comparison-content {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .controls {
                flex-direction: column;
            }
            
            .btn-process {
                width: 100%;
                max-width: none;
            }
        }

        @media (max-width: 480px) {
            body {
                padding: 10px 5px;
            }
            
            .container {
                padding: 15px;
                border-radius: 10px;
            }
            
            h1 {
                font-size: 1.5em;
            }
            
            .stats-panel {
                grid-template-columns: 1fr;
            }
            
            .upload-buttons {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }
        }

        /* === VERY SMALL SCREENS === */
        @media (max-width: 320px) {
            .container {
                padding: 10px;
            }
            
            .stat-value {
                font-size: 1.5em;
            }
            
            .image-container {
                height: 120px;
            }
        }
    </style>
    <!-- SweetAlert2 for notifications -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <!-- JSZip for creating zip files -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <!-- FileSaver.js for saving files -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
</head>
<body>
    <!-- BONG B√ìNG CHAT -->
    <div class="lazinet-contact-floating">
        <!-- Main Button -->
        <div class="lazinet-contact-main-btn pulse">
            <img src="../assets/img/logo-lazinet/lazinet_LogoOnly_extending.svg" alt="Contact Us">
        </div>
        
        <!-- Contact Buttons -->
        <div class="lazinet-contact-buttons">
            <!-- AI Bot -->
            <div class="lazinet-contact-btn ai-bot" title="Chat v·ªõi tr·ª£ l√Ω ·∫£o LAZINET">
                <img src="../assets/img/others/chatbot.svg" alt="AI Assistant">
                <span class="lazinet-contact-label">AI Assistant</span>
            </div>
            
            <!-- Messenger -->
            <div class="lazinet-contact-btn messenger" title="Chat v·ªõi LAZINET Messenger">
                <img src="../assets/img/others/messenger.png" alt="Messenger">
                <span class="lazinet-contact-label">Messenger</span>
            </div>
            
            <!-- Zalo -->
            <div class="lazinet-contact-btn zalo" title="Chat v·ªõi LAZINET Zalo 0908556220">
                <img src="../assets/img/others/zalo.png" alt="Zalo">
                <span class="lazinet-contact-label">Zalo Chat</span>
            </div>
            
            <!-- Phone -->
            <div class="lazinet-contact-btn phone" title="G·ªçi ngay LAZINET 0908556220">
                <img src="../assets/img/others/call.png" alt="Phone">
                <span class="lazinet-contact-label">G·ªçi ƒëi·ªán</span>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- Header -->
        <div class="header">
            <a href="../lazinet-support-pricing.html">
                <div style="display: flex; justify-content: center; align-items: center;">
                    <img src="../assets/img/logo-lazinet/lazinet_LogoFullv2_vi.png" alt="LAZINET Logo" class="logo">
                </div>
                <h1>LAZINET Image Conversion, Compression & Background Removal</h1>
                <p class="subtitle">X√≥a n·ªÅn, chuy·ªÉn ƒë·ªïi & n√©n ·∫£nh h√†ng lo·∫°t sang c√°c ƒë·ªãnh d·∫°ng v·ªõi t√πy ch·ªânh th√¥ng minh</p>
            </a>
        </div>

        <div class="main-content">
            <!-- Control Panel -->
            <div class="control-panel">
                <!-- Upload Section -->
                <div class="panel-section">
                    <div class="section-title">
                        <span>üì§</span>
                        <span>T·∫£i ·∫£nh l√™n</span>
                    </div>
                    <div class="upload-area" id="uploadArea">
                        <div class="upload-icon">üìÅ</div>
                        <div class="upload-text">K√©o & Th·∫£ ·∫£nh v√†o ƒë√¢y</div>
                        <div class="upload-hint">ho·∫∑c nh·∫•p ƒë·ªÉ ch·ªçn file</div>
                        <div class="upload-buttons">
                            <button class="btn btn-primary" onclick="document.getElementById('fileInput').click()">
                                üìÑ Ch·ªçn File ·∫¢nh
                            </button>
                            <button class="btn btn-secondary" onclick="document.getElementById('folderInput').click()">
                                üìÅ Ch·ªçn Th∆∞ M·ª•c
                            </button>
                        </div>
                        <input type="file" id="fileInput" class="file-input" accept=".jpg,.jpeg,.png,.gif,.bmp,.tiff,.webp" multiple style="display: none;">
                        <input type="file" id="folderInput" webkitdirectory mozdirectory multiple accept="image/*" style="display: none;">
                        <div class="error" id="uploadError" style="margin-top: 10px;"></div>
                    </div>
                </div>

                <!-- Background Removal Options -->
                <div class="panel-section">
                    <div class="section-title">
                        <span>üé≠</span>
                        <span>T√πy ch·ªçn x√≥a n·ªÅn</span>
                    </div>
                    
                    <div class="form-group">
                        <label for="bgRemovalMode">Ch·∫ø ƒë·ªô x·ª≠ l√Ω n·ªÅn:</label>
                        <select id="bgRemovalMode">
                            <option value="none">Kh√¥ng x√≥a n·ªÅn</option>
                            <option value="transparent">X√≥a n·ªÅn trong su·ªët (PNG)</option>
                            <option value="white">N·ªÅn tr·∫Øng</option>
                            <option value="black">N·ªÅn ƒëen</option>
                            <option value="custom">N·ªÅn t√πy ch·ªânh</option>
                            <option value="blur">L√†m m·ªù n·ªÅn</option>
                            <option value="gradient">N·ªÅn gradient</option>
                        </select>
                    </div>

                    <div id="bgRemovalOptions" class="bg-removal-options" style="display: none;">
                        <!-- Custom Color Picker -->
                        <div class="bg-option-row" id="customColorRow" style="display: none;">
                            <label class="bg-checkbox-label">
                                M√†u n·ªÅn t√πy ch·ªânh:
                            </label>
                            <input type="color" id="bgCustomColor" class="bg-color-picker" value="#FFFFFF">
                        </div>

                        <!-- Blur Intensity -->
                        <div class="bg-option-row" id="blurIntensityRow" style="display: none;">
                            <label class="bg-checkbox-label">
                                ƒê·ªô m·ªù n·ªÅn:
                            </label>
                            <input type="range" id="bgBlurIntensity" class="bg-intensity-slider" min="1" max="20" value="5">
                            <span class="bg-intensity-value" id="blurValue">5px</span>
                        </div>

                        <!-- Gradient Options -->
                        <div class="bg-option-row" id="gradientOptionsRow" style="display: none;">
                            <label class="bg-checkbox-label">
                                M√†u gradient 1:
                            </label>
                            <input type="color" id="bgGradientColor1" class="bg-color-picker" value="#FF0000">
                            <label class="bg-checkbox-label" style="margin-left: 10px;">
                                M√†u gradient 2:
                            </label>
                            <input type="color" id="bgGradientColor2" class="bg-color-picker" value="#0000FF">
                        </div>

                        <!-- Edge Smoothing -->
                        <div class="bg-option-row">
                            <label class="bg-checkbox-label" for="edgeSmoothing">
                                <input type="checkbox" id="edgeSmoothing" checked>
                                L√†m m·ªãn vi·ªÅn ƒë·ªëi t∆∞·ª£ng
                            </label>
                        </div>

                        <!-- Sensitivity -->
                        <div class="bg-option-row">
                            <label class="bg-checkbox-label">
                                ƒê·ªô nh·∫°y x√≥a n·ªÅn:
                            </label>
                            <input type="range" id="bgSensitivity" class="bg-intensity-slider" min="1" max="10" value="5">
                            <span class="bg-intensity-value" id="sensitivityValue">5</span>
                        </div>
                    </div>
                </div>

                <!-- Resize Options -->
                <div class="panel-section">
                    <div class="section-title">
                        <span>üìè</span>
                        <span>T√πy ch·ªânh k√≠ch th∆∞·ªõc</span>
                    </div>
                    <div class="radio-group">
                        <label class="radio-option" id="resizeOption1">
                            <input type="radio" name="resizeOption" value="0">
                            <span>Gi·ªØ nguy√™n k√≠ch th∆∞·ªõc g·ªëc</span>
                        </label>
                        <label class="radio-option" id="resizeOption2">
                            <input type="radio" name="resizeOption" value="1" checked>
                            <span>Thay ƒë·ªïi chi·ªÅu r·ªông</span>
                        </label>
                        <label class="radio-option" id="resizeOption3">
                            <input type="radio" name="resizeOption" value="2">
                            <span>Thay ƒë·ªïi chi·ªÅu cao</span>
                        </label>
                    </div>
                    
                    <div class="form-group" id="sizeInputGroup" style="display: none;">
                        <label id="sizeLabel">K√≠ch th∆∞·ªõc m·ª•c ti√™u (px)</label>
                        <div style="display: flex; gap: 10px; align-items: center;">
                            <input type="number" id="targetSize" value="1024" min="1" max="10000" style="flex: 1; min-width: 200px;">
                            <button class="btn btn-secondary" style="padding: 8px 12px; font-size: 12px;" onclick="applySuggestedSize()">
                                G·ª£i √Ω
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Processing Settings -->
                <div class="panel-section">
                    <div class="section-title">
                        <span>‚öôÔ∏è</span>
                        <span>C√†i ƒë·∫∑t x·ª≠ l√Ω</span>
                    </div>
                    
                    <div class="form-group">
                        <label for="resampleMethod">Thu·∫≠t to√°n l·∫•y m·∫´u:</label>
                        <select id="resampleMethod">
                            <option value="lanczos">LANCZOS (Ch·∫•t l∆∞·ª£ng cao)</option>
                            <option value="bicubic">BICUBIC (C√¢n b·∫±ng)</option>
                            <option value="bilinear">BILINEAR (Nhanh)</option>
                            <option value="nearest">NEAREST (Si√™u nhanh)</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="enhanceMode">Ch·∫ø ƒë·ªô l√†m ƒë·∫πp:</label>
                        <select id="enhanceMode">
                            <option value="none">Kh√¥ng l√†m ƒë·∫πp</option>
                            <option value="light">L√†m ƒë·∫πp nh·∫π</option>
                            <option value="medium">L√†m ƒë·∫πp v·ª´a</option>
                            <option value="shiny">Lung linh ·∫£o l√≤i</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="outputFormat">ƒê·ªãnh d·∫°ng ƒë·∫ßu ra:</label>
                        <select id="outputFormat">
                            <option value="webp">WebP (N√©n t·ªët nh·∫•t)</option>
                            <option value="avif">AVIF (Hi·ªán ƒë·∫°i, n√©n si√™u t·ªët)</option>
                            <option value="png">PNG (Kh√¥ng m·∫•t d·ªØ li·ªáu)</option>
                            <option value="jpg">JPG (T∆∞∆°ng th√≠ch cao)</option>
                        </select>
                    </div>
                </div>

                <!-- Quality Settings -->
                <div class="panel-section">
                    <div class="section-title">
                        <span>üéØ</span>
                        <span>Ch·∫•t l∆∞·ª£ng ƒë·∫ßu ra</span>
                    </div>
                    
                    <div class="form-group">
                        <label for="quality">
                            Ch·∫•t l∆∞·ª£ng (0-100):
                            <span class="range-value" id="qualityValue">80%</span>
                        </label>
                        <input type="range" id="quality" min="0" max="100" value="80">
                    </div>
                </div>

                <!-- Output Options -->
                <div class="panel-section">
                    <div class="section-title">
                        <span>üì¶</span>
                        <span>T√πy ch·ªçn xu·∫•t file</span>
                    </div>
                    
                    <div class="radio-group">
                        <label class="radio-option">
                            <input type="radio" name="outputOption" value="individual" checked>
                            <span>Xu·∫•t t·ª´ng file ri√™ng l·∫ª</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="outputOption" value="zip">
                            <span>N√©n th√†nh 1 file ZIP</span>
                        </label>
                    </div>
                </div>
            </div>

            <!-- Preview Section -->
            <div class="preview-section">
                <div class="preview-header">
                    <div class="preview-title">So s√°nh ·∫£nh tr∆∞·ªõc/ sau x·ª≠ l√Ω</div>
                    <div id="fileCount">0 ·∫£nh ƒë√£ ch·ªçn</div>
                </div>

                <!-- Processing Status -->
                <div id="processingStatus" class="processing-status" style="display: none;">
                    <div class="status-dot"></div>
                    <span id="statusText">ƒêang x·ª≠ l√Ω ·∫£nh...</span>
                </div>

                <div id="previewGrid" class="preview-grid">
                    <!-- Image comparison cards will be inserted here -->
                    <div class="empty-state" style="text-align: center; padding: 40px; opacity: 0.7;">
                        <div style="font-size: 48px; margin-bottom: 20px;">üìÅ</div>
                        <div style="font-size: 1.1em; margin-bottom: 10px;">Ch∆∞a c√≥ ·∫£nh n√†o ƒë∆∞·ª£c ch·ªçn</div>
                        <div style="font-size: 0.9em;">H√£y ch·ªçn file ·∫£nh ho·∫∑c th∆∞ m·ª•c ƒë·ªÉ b·∫Øt ƒë·∫ßu</div>
                    </div>
                </div>

                <!-- Progress Bar -->
                <div class="progress-container" id="progressContainer" style="display: none;">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                    <div class="progress-text">
                        <span>ƒêang x·ª≠ l√Ω: <span id="currentProcess">0</span>/<span id="totalProcess">0</span></span>
                        <span id="progressPercent">0%</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Controls -->
        <div class="controls">
            <button class="btn btn-primary btn-large btn-process" onclick="processBatch()" id="processBtn" disabled>
                <span>üöÄ</span> X·ª≠ L√Ω T·∫•t C·∫£ ·∫¢nh
            </button>
            <button class="btn btn-secondary btn-large" onclick="resetTool()">
                <span>üîÑ</span> Thi·∫øt L·∫≠p L·∫°i
            </button>
        </div>

        <!-- Statistics Panel -->
        <div class="stats-panel" id="statsPanel" style="display: none;">
            <div class="stat-item">
                <div class="stat-value" id="totalImages">0</div>
                <div class="stat-label">T·ªïng s·ªë ·∫£nh</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="originalSize">0 MB</div>
                <div class="stat-label">K√≠ch th∆∞·ªõc g·ªëc</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="compressedSize">0 MB</div>
                <div class="stat-label">K√≠ch th∆∞·ªõc sau n√©n</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="compressedSave">0 MB</div>
                <div class="stat-label">Ti·∫øt ki·ªám</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="compressionRatio">0%</div>
                <div class="stat-label">T·ªâ l·ªá n√©n c√≤n</div>
            </div>
        </div>

        <footer>
            <div class="footer-copyright-text">
                <p>Image Conversion, Compression & Background Removal <span style="color: #ff6302;"><b>LAZI</b></span><span style="color: #0000ff;"><b>NET</b></span> &copy;
                    <script>
                        const startYear = 2024;
                        const currentYear = new Date().getFullYear();
                        document.write(`${startYear}‚Äì${currentYear}`);
                    </script>
                </p>
            </div>
        </footer>
    </div>

    <script>
        // Global variables
        let files = [];
        let processedImages = [];
        let minWidth = Infinity;
        let minHeight = Infinity;
        let suggestedWidth = 1024;
        let suggestedHeight = 1024;
        let isProcessing = false;
        let resizeShort = 'Original';

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            initializeEventListeners();
            updateRadioButtons();
            updateSizeInput();
            updateQualityValue();
            setupBackgroundRemovalOptions();
        });

        // Initialize event listeners
        function initializeEventListeners() {
            // Upload area events
            const uploadArea = document.getElementById('uploadArea');
            uploadArea.addEventListener('click', handleUploadClick);
            uploadArea.addEventListener('dragover', handleDragOver);
            uploadArea.addEventListener('drop', handleDrop);

            // File input change
            document.getElementById('fileInput').addEventListener('change', (e) => {
                handleFiles(Array.from(e.target.files));
            });

            // Folder input change
            document.getElementById('folderInput').addEventListener('change', (e) => {
                handleFiles(Array.from(e.target.files));
            });

            // Radio buttons
            document.querySelectorAll('input[name="resizeOption"]').forEach(radio => {
                radio.addEventListener('change', updateSizeInput);
            });

            // Quality slider
            document.getElementById('quality').addEventListener('input', updateQualityValue);
            
            // Background removal mode change
            document.getElementById('bgRemovalMode').addEventListener('change', updateBgRemovalOptions);
            
            // Background option sliders
            document.getElementById('bgBlurIntensity').addEventListener('input', function() {
                document.getElementById('blurValue').textContent = this.value + 'px';
            });
            
            document.getElementById('bgSensitivity').addEventListener('input', function() {
                document.getElementById('sensitivityValue').textContent = this.value;
            });
        }

        // Setup background removal options
        function setupBackgroundRemovalOptions() {
            updateBgRemovalOptions();
        }

        // Update background removal options based on selection
        function updateBgRemovalOptions() {
            const mode = document.getElementById('bgRemovalMode').value;
            const optionsDiv = document.getElementById('bgRemovalOptions');
            
            if (mode === 'none') {
                optionsDiv.style.display = 'none';
            } else {
                optionsDiv.style.display = 'block';
                
                // Show/hide specific options
                document.getElementById('customColorRow').style.display = mode === 'custom' ? 'flex' : 'none';
                document.getElementById('blurIntensityRow').style.display = mode === 'blur' ? 'flex' : 'none';
                document.getElementById('gradientOptionsRow').style.display = mode === 'gradient' ? 'flex' : 'none';
            }
        }

        // Update radio button UI
        function updateRadioButtons() {
            document.querySelectorAll('.radio-option').forEach(option => {
                option.addEventListener('click', function() {
                    const radio = this.querySelector('input[type="radio"]');
                    if (radio) {
                        radio.checked = true;
                        document.querySelectorAll('.radio-option').forEach(o => o.classList.remove('selected'));
                        this.classList.add('selected');
                        updateSizeInput();
                    }
                });
            });
        }

        // Update size input visibility and label
        function updateSizeInput() {
            const resizeOption = document.querySelector('input[name="resizeOption"]:checked').value;
            const sizeInputGroup = document.getElementById('sizeInputGroup');
            const sizeLabel = document.getElementById('sizeLabel');
            
            if (resizeOption === '0') {
                sizeInputGroup.style.display = 'none';
                resizeShort = 'Original';
            } else {
                sizeInputGroup.style.display = 'block';
                if (resizeOption === '1') {
                    sizeLabel.textContent = 'Chi·ªÅu r·ªông m·ª•c ti√™u (px)';
                    document.getElementById('targetSize').value = suggestedWidth;
                    resizeShort = 'W' + suggestedWidth;
                } else {
                    sizeLabel.textContent = 'Chi·ªÅu cao m·ª•c ti√™u (px)';
                    document.getElementById('targetSize').value = suggestedHeight;
                    resizeShort = 'H' + suggestedHeight;
                }
            }
        }

        // Update quality value display
        function updateQualityValue() {
            document.getElementById('qualityValue').textContent = document.getElementById('quality').value + '%';
        }

        // Handle upload click
        function handleUploadClick(e) {
            if (e.target.closest('.btn') || e.target.closest('input[type="file"]')) {
                return;
            }
        }

        // Handle drag over
        function handleDragOver(e) {
            e.preventDefault();
            e.stopPropagation();
            document.getElementById('uploadArea').classList.add('dragover');
        }

        // Handle drop
        function handleDrop(e) {
            e.preventDefault();
            e.stopPropagation();
            document.getElementById('uploadArea').classList.remove('dragover');
            
            const droppedFiles = Array.from(e.dataTransfer.files);
            handleFiles(droppedFiles);
        }

        // Handle files
        async function handleFiles(fileArray) {
            // Filter for image files
            const imageFiles = fileArray.filter(file => 
                file.type.startsWith('image/') && 
                ['.jpg', '.jpeg', '.png', '.gif', '.bmp', '.tiff', '.webp', '.jfif'].some(ext => 
                    file.name.toLowerCase().endsWith(ext)
                )
            );
            
            if (imageFiles.length === 0) {
                showError('Kh√¥ng c√≥ file ·∫£nh h·ª£p l·ªá! Vui l√≤ng ch·ªçn file JPG, PNG, GIF, BMP, TIFF ho·∫∑c WebP.');
                return;
            }
            
            // Clear previous files
            files = [];
            processedImages = [];
            minWidth = Infinity;
            minHeight = Infinity;
            
            // Add new files
            files.push(...imageFiles);
            
            // Calculate min dimensions for suggestions
            await calculateMinDimensions(imageFiles);
            
            // Calculate suggested sizes
            calculateSuggestedSizes();
            
            // Update UI
            updateFileCount();
            updateStatistics();
            createPreviewCards();
            updateSizeInput();
            
            // Enable process button
            document.getElementById('processBtn').disabled = false;
            
            // Hide error
            document.getElementById('uploadError').style.display = 'none';
            
            showNotification(`ƒê√£ th√™m ${imageFiles.length} ·∫£nh!`, 'success');
        }

        // Calculate minimum dimensions from all images
        async function calculateMinDimensions(imageFiles) {
            const promises = imageFiles.map(file => {
                return new Promise((resolve) => {
                    const img = new Image();
                    img.onload = () => {
                        minWidth = Math.min(minWidth, img.width);
                        minHeight = Math.min(minHeight, img.height);
                        resolve();
                    };
                    img.onerror = () => {
                        resolve();
                    };
                    img.src = URL.createObjectURL(file);
                });
            });
            
            await Promise.all(promises);
            
            // Clean up object URLs
            imageFiles.forEach(file => {
                URL.revokeObjectURL(file);
            });
        }

        // Calculate suggested sizes based on min dimensions
        function calculateSuggestedSizes() {
            function nearestPowerOf2Below(value) {
                if (value <= 0) return 256;
                let power = 1;
                while (power * 2 <= value) {
                    power *= 2;
                }
                return Math.min(1024, Math.max(128, power));
            }
            
            suggestedWidth = nearestPowerOf2Below(minWidth);
            suggestedHeight = nearestPowerOf2Below(minHeight);
            
            console.log(`Min dimensions: ${minWidth}x${minHeight}`);
            console.log(`Suggested sizes: ${suggestedWidth}w, ${suggestedHeight}h`);
        }

        // Apply suggested size
        function applySuggestedSize() {
            const resizeOption = document.querySelector('input[name="resizeOption"]:checked').value;
            if (resizeOption === '1') {
                document.getElementById('targetSize').value = suggestedWidth;
                showNotification(`ƒê√£ √°p d·ª•ng chi·ªÅu r·ªông g·ª£i √Ω: ${suggestedWidth}px`, 'info');
                resizeShort = 'W' + suggestedWidth;
            } else if (resizeOption === '2') {
                document.getElementById('targetSize').value = suggestedHeight;
                showNotification(`ƒê√£ √°p d·ª•ng chi·ªÅu cao g·ª£i √Ω: ${suggestedHeight}px`, 'info');
                resizeShort = 'H' + suggestedHeight;
            }
        }

        // Update file count display
        function updateFileCount() {
            document.getElementById('fileCount').textContent = `${files.length} ·∫£nh ƒë√£ ch·ªçn`;
        }

        // Create preview cards
        async function createPreviewCards() {
            const previewGrid = document.getElementById('previewGrid');
            
            // Clear existing content
            previewGrid.innerHTML = '';
            
            // Create cards for each file
            for (const file of files) {
                const card = await createImageCard(file);
                previewGrid.appendChild(card);
            }
            
            // Show preview section
            document.getElementById('progressContainer').style.display = 'none';
            document.getElementById('processingStatus').style.display = 'none';
        }

        // Create image comparison card
        async function createImageCard(file) {
            return new Promise((resolve) => {
                const reader = new FileReader();
                reader.onload = (e) => {
                    const img = new Image();
                    img.onload = () => {
                        const card = document.createElement('div');
                        card.className = 'image-comparison-card';
                        card.dataset.fileName = file.name;
                        
                        const fileSizeKB = (file.size / 1024).toFixed(1);
                        const aspectRatio = (img.width / img.height).toFixed(2);
                        const fileType = file.name.split('.').pop().toUpperCase();
                        
                        card.innerHTML = `
                            <div class="comparison-header">
                                <div class="file-name" title="${file.name}">${truncateFileName(file.name)}</div>
                                <div style="font-size: 0.85em; opacity: 0.8;">${fileSizeKB} KB</div>
                            </div>
                            <div class="comparison-content">
                                <!-- Original Image -->
                                <div>
                                    <div class="image-container">
                                        <img src="${e.target.result}" alt="Original" class="image-preview">
                                        <div class="image-info">
                                            <div class="info-top">
                                                <span>${fileType}</span>
                                                <span>${img.width}√ó${img.height}</span>
                                            </div>
                                            <div class="info-bottom">
                                                <span>${fileSizeKB} KB</span>
                                                <span>${aspectRatio}:1</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div style="text-align: center; font-size: 0.85em; margin-top: 5px; opacity: 0.8;">
                                        ·∫¢nh g·ªëc
                                    </div>
                                </div>
                                
                                <!-- Processed Image -->
                                <div>
                                    <div class="image-container transparent-bg">
                                        <div style="display: flex; align-items: center; justify-content: center; height: 100%; color: rgba(255,255,255,0.5);">
                                            Ch∆∞a x·ª≠ l√Ω
                                        </div>
                                        <div class="image-info">
                                            <div class="info-top">
                                                <span>-</span>
                                                <span>-</span>
                                            </div>
                                            <div class="info-bottom">
                                                <span>-</span>
                                                <span class="compression-ratio">-</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div style="text-align: center; font-size: 0.85em; margin-top: 5px; opacity: 0.8;">
                                        Sau x·ª≠ l√Ω
                                    </div>
                                </div>
                            </div>
                        `;
                        
                        resolve(card);
                    };
                    img.onerror = () => {
                        const card = document.createElement('div');
                        card.className = 'image-comparison-card';
                        card.innerHTML = `
                            <div style="padding: 20px; text-align: center; opacity: 0.7;">
                                <div style="font-size: 24px; margin-bottom: 10px;">‚ö†Ô∏è</div>
                                <div>Kh√¥ng th·ªÉ load ·∫£nh: ${file.name}</div>
                            </div>
                        `;
                        resolve(card);
                    };
                    img.src = e.target.result;
                };
                reader.readAsDataURL(file);
            });
        }

        // Truncate file name for display
        function truncateFileName(name, maxLength = 30) {
            if (name.length <= maxLength) return name;
            const extension = name.split('.').pop();
            const nameWithoutExt = name.slice(0, -(extension.length + 1));
            const truncateLength = maxLength - extension.length - 4;
            return nameWithoutExt.slice(0, truncateLength) + '...' + extension;
        }

        // Update statistics
        function updateStatistics() {
            if (files.length === 0) {
                document.getElementById('statsPanel').style.display = 'none';
                return;
            }
            
            document.getElementById('statsPanel').style.display = 'grid';
            
            const totalSize = files.reduce((sum, file) => sum + file.size, 0);
            const totalSizeMB = (totalSize / (1024 * 1024)).toFixed(2);
            
            document.getElementById('totalImages').textContent = files.length;
            document.getElementById('originalSize').textContent = `${totalSizeMB} MB`;
            
            // Update other stats after processing
            document.getElementById('compressedSize').textContent = '0 MB';
            document.getElementById('compressionRatio').textContent = '0%';
        }

        // Process batch
        async function processBatch() {
            if (isProcessing || files.length === 0) return;
            
            isProcessing = true;
            const processBtn = document.getElementById('processBtn');
            const progressContainer = document.getElementById('progressContainer');
            const progressFill = document.getElementById('progressFill');
            const processingStatus = document.getElementById('processingStatus');
            const statusText = document.getElementById('statusText');
            
            // Disable button and show progress
            processBtn.disabled = true;
            processBtn.innerHTML = '<span>‚è≥</span> ƒêang x·ª≠ l√Ω...';
            progressContainer.style.display = 'block';
            processingStatus.style.display = 'flex';
            
            // Reset processed images
            processedImages = [];
            let totalOriginalSize = 0;
            let totalCompressedSize = 0;
            let totalCompressedSave = 0;
            
            // Get settings
            const resizeOption = document.querySelector('input[name="resizeOption"]:checked').value;
            const targetSize = parseInt(document.getElementById('targetSize').value) || 1024;
            const quality = parseInt(document.getElementById('quality').value) / 100;
            const resampleMethod = document.getElementById('resampleMethod').value;
            const enhanceMode = document.getElementById('enhanceMode').value;
            const outputFormat = document.getElementById('outputFormat').value;
            const outputOption = document.querySelector('input[name="outputOption"]:checked').value;
            
            // Background removal settings
            const bgRemovalMode = document.getElementById('bgRemovalMode').value;
            const bgCustomColor = document.getElementById('bgCustomColor').value;
            const bgBlurIntensity = parseInt(document.getElementById('bgBlurIntensity').value);
            const bgGradientColor1 = document.getElementById('bgGradientColor1').value;
            const bgGradientColor2 = document.getElementById('bgGradientColor2').value;
            const edgeSmoothing = document.getElementById('edgeSmoothing').checked;
            const bgSensitivity = parseInt(document.getElementById('bgSensitivity').value);
            
            // Process each file
            for (let i = 0; i < files.length; i++) {
                const file = files[i];
                
                // Update progress
                document.getElementById('currentProcess').textContent = i + 1;
                document.getElementById('totalProcess').textContent = files.length;
                const progress = Math.round(((i + 1) / files.length) * 100);
                progressFill.style.width = progress + '%';
                document.getElementById('progressPercent').textContent = progress + '%';
                statusText.textContent = `ƒêang x·ª≠ l√Ω ·∫£nh ${i + 1}/${files.length}: ${truncateFileName(file.name)}`;
                
                try {
                    // Process image
                    const result = await processSingleImage(file, {
                        resizeOption,
                        targetSize,
                        quality,
                        resampleMethod,
                        enhanceMode,
                        outputFormat,
                        bgRemovalMode,
                        bgCustomColor,
                        bgBlurIntensity,
                        bgGradientColor1,
                        bgGradientColor2,
                        edgeSmoothing,
                        bgSensitivity
                    });
                    
                    // Update card with processed image
                    updateImageCard(file.name, result);
                    
                    // Add to processed images
                    processedImages.push({
                        name: file.name.replace(/\.[^/.]+$/, '') + '_processed.' + outputFormat,
                        blob: result.blob,
                        originalSize: file.size,
                        compressedSize: result.blob.size,
                        compressionRatio: (result.blob.size / file.size * 100).toFixed(1)
                    });
                    
                    // Update totals
                    totalOriginalSize += file.size;
                    totalCompressedSize += result.blob.size;
                    totalCompressedSave = totalOriginalSize - totalCompressedSize;
                    
                } catch (error) {
                    console.error(`Error processing ${file.name}:`, error);
                    showNotification(`L·ªói khi x·ª≠ l√Ω ${file.name}`, 'error');
                }
                
                // Give UI time to update
                await new Promise(resolve => setTimeout(resolve, 50));
            }
            
            // Update final statistics
            const totalOriginalSizeMB = (totalOriginalSize / (1024 * 1024)).toFixed(2);
            const totalCompressedSizeMB = (totalCompressedSize / (1024 * 1024)).toFixed(2);
            const totalCompressedSaveMB = (totalOriginalSizeMB - totalCompressedSizeMB).toFixed(2);
            const overallCompressionRatio = ((totalCompressedSize / totalOriginalSize) * 100).toFixed(1);
            
            document.getElementById('compressedSize').textContent = `${totalCompressedSizeMB} MB`;
            document.getElementById('compressedSave').textContent = `${totalCompressedSaveMB} MB`;
            document.getElementById('compressionRatio').textContent = `${overallCompressionRatio}%`;
            
            // Reset button
            processBtn.disabled = false;
            processBtn.innerHTML = '<span>üöÄ</span> X·ª≠ L√Ω T·∫•t C·∫£ ·∫¢nh';
            
            // Hide status
            processingStatus.style.display = 'none';
            
            // Download results
            await downloadResults(outputOption);
            
            // Show completion message
            showNotification(`ƒê√£ x·ª≠ l√Ω xong ${files.length} ·∫£nh! Ti·∫øt ki·ªám ƒë∆∞·ª£c ${(totalOriginalSizeMB - totalCompressedSizeMB).toFixed(2)}MB (${overallCompressionRatio}%)`, 'success');
            
            isProcessing = false;
        }

        // Process single image with background removal
        async function processSingleImage(file, settings) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = (e) => {
                    const img = new Image();
                    img.onload = () => {
                        const canvas = document.createElement('canvas');
                        const ctx = canvas.getContext('2d');
                        resizeShort = 'Original';
                        let { width, height } = img;
                        
                        // Apply resize
                        if (settings.resizeOption === '1') {
                            height = Math.round(height * settings.targetSize / width);
                            width = settings.targetSize;
                            resizeShort = 'W' + width;
                        } else if (settings.resizeOption === '2') {
                            width = Math.round(width * settings.targetSize / height);
                            height = settings.targetSize;
                            resizeShort = 'H' + height;
                        }
                        
                        canvas.width = width;
                        canvas.height = height;
                        
                        // Draw original image
                        ctx.drawImage(img, 0, 0, width, height);
                        
                        // Apply background removal if needed
                        if (settings.bgRemovalMode !== 'none') {
                            applyBackgroundRemoval(canvas, ctx, width, height, settings);
                        }
                        
                        // Apply enhancements
                        if (settings.enhanceMode !== 'none') {
                            const imageData = ctx.getImageData(0, 0, width, height);
                            const data = imageData.data;
                            
                            let brightness = 1, contrast = 1;
                            if (settings.enhanceMode === 'light') {
                                brightness = contrast = 1.1;
                            } else if (settings.enhanceMode === 'medium') {
                                brightness = contrast = 1.2;
                            } else if (settings.enhanceMode === 'shiny') {
                                brightness = contrast = 1.4;
                            }
                            
                            // Apply brightness and contrast
                            for (let i = 0; i < data.length; i += 4) {
                                // Brightness
                                data[i] = Math.min(255, data[i] * brightness);
                                data[i + 1] = Math.min(255, data[i + 1] * brightness);
                                data[i + 2] = Math.min(255, data[i + 2] * brightness);
                                
                                // Contrast
                                data[i] = 128 + (data[i] - 128) * contrast;
                                data[i + 1] = 128 + (data[i + 1] - 128) * contrast;
                                data[i + 2] = 128 + (data[i + 2] - 128) * contrast;
                                
                                // Clamp values
                                data[i] = Math.max(0, Math.min(255, data[i]));
                                data[i + 1] = Math.max(0, Math.min(255, data[i + 1]));
                                data[i + 2] = Math.max(0, Math.min(255, data[i + 2]));
                            }
                            
                            ctx.putImageData(imageData, 0, 0);
                        }
                        
                        // Convert to blob with specified format
                        const mimeType = settings.outputFormat === 'webp' ? 'image/webp' :
                                        settings.outputFormat === 'avif' ? 'image/avif' :
                                        settings.outputFormat === 'png' ? 'image/png' : 'image/jpeg';
                        
                        canvas.toBlob((blob) => {
                            resolve({
                                blob,
                                width,
                                height
                            });
                        }, mimeType, settings.quality);
                    };
                    img.onerror = reject;
                    img.src = e.target.result;
                };
                reader.onerror = reject;
                reader.readAsDataURL(file);
            });
        }

        // Apply background removal to canvas
        function applyBackgroundRemoval(canvas, ctx, width, height, settings) {
            // Get image data
            const imageData = ctx.getImageData(0, 0, width, height);
            const data = imageData.data;
            
            // Simple background removal based on color detection
            // This is a basic implementation - for production, consider using a more advanced algorithm
            const sensitivity = settings.bgSensitivity / 10;
            
            // Sample background color from corners
            const corners = [
                {x: 0, y: 0}, {x: width-1, y: 0},
                {x: 0, y: height-1}, {x: width-1, y: height-1}
            ];
            
            let bgR = 0, bgG = 0, bgB = 0;
            corners.forEach(corner => {
                const idx = (corner.y * width + corner.x) * 4;
                bgR += data[idx];
                bgG += data[idx + 1];
                bgB += data[idx + 2];
            });
            
            bgR = Math.round(bgR / corners.length);
            bgG = Math.round(bgG / corners.length);
            bgB = Math.round(bgB / corners.length);
            
            // Process each pixel
            for (let i = 0; i < data.length; i += 4) {
                const r = data[i];
                const g = data[i + 1];
                const b = data[i + 2];
                
                // Calculate color difference from background
                const diff = Math.sqrt(
                    Math.pow(r - bgR, 2) +
                    Math.pow(g - bgG, 2) +
                    Math.pow(b - bgB, 2)
                ) / 441.67; // Normalize to 0-1 (441.67 = sqrt(255^2 + 255^2 + 255^2))
                
                // If pixel is similar to background, apply removal
                if (diff < sensitivity) {
                    switch(settings.bgRemovalMode) {
                        case 'transparent':
                            // Make transparent
                            data[i + 3] = 0;
                            break;
                        case 'white':
                            // Make white
                            data[i] = 255;
                            data[i + 1] = 255;
                            data[i + 2] = 255;
                            break;
                        case 'black':
                            // Make black
                            data[i] = 0;
                            data[i + 1] = 0;
                            data[i + 2] = 0;
                            break;
                        case 'custom':
                            // Apply custom color
                            const customColor = hexToRgb(settings.bgCustomColor);
                            data[i] = customColor.r;
                            data[i + 1] = customColor.g;
                            data[i + 2] = customColor.b;
                            break;
                        case 'blur':
                            // For blur, we'll handle it differently
                            break;
                        case 'gradient':
                            // Apply gradient based on position
                            const x = (i / 4) % width;
                            const y = Math.floor((i / 4) / width);
                            const ratio = x / width;
                            
                            const color1 = hexToRgb(settings.bgGradientColor1);
                            const color2 = hexToRgb(settings.bgGradientColor2);
                            
                            data[i] = color1.r + (color2.r - color1.r) * ratio;
                            data[i + 1] = color1.g + (color2.g - color1.g) * ratio;
                            data[i + 2] = color1.b + (color2.b - color1.b) * ratio;
                            break;
                    }
                }
            }
            
            // Apply edge smoothing if enabled
            if (settings.edgeSmoothing) {
                smoothEdges(data, width, height, sensitivity);
            }
            
            // Apply blur background if selected
            if (settings.bgRemovalMode === 'blur') {
                applyBlurBackground(canvas, ctx, width, height, settings.bgBlurIntensity, sensitivity);
                return; // Skip putting image data as blur handles it
            }
            
            // Put modified image data back
            ctx.putImageData(imageData, 0, 0);
        }

        // Convert hex color to RGB
        function hexToRgb(hex) {
            const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
            return result ? {
                r: parseInt(result[1], 16),
                g: parseInt(result[2], 16),
                b: parseInt(result[3], 16)
            } : {r: 255, g: 255, b: 255};
        }

        // Simple edge smoothing
        function smoothEdges(data, width, height, sensitivity) {
            const tempData = new Uint8ClampedArray(data);
            
            for (let y = 1; y < height - 1; y++) {
                for (let x = 1; x < width - 1; x++) {
                    const idx = (y * width + x) * 4;
                    const alpha = data[idx + 3];
                    
                    // If pixel is semi-transparent (edge)
                    if (alpha > 0 && alpha < 255) {
                        // Average with surrounding pixels
                        let r = 0, g = 0, b = 0, a = 0;
                        let count = 0;
                        
                        for (let dy = -1; dy <= 1; dy++) {
                            for (let dx = -1; dx <= 1; dx++) {
                                const neighborIdx = ((y + dy) * width + (x + dx)) * 4;
                                r += tempData[neighborIdx];
                                g += tempData[neighborIdx + 1];
                                b += tempData[neighborIdx + 2];
                                a += tempData[neighborIdx + 3];
                                count++;
                            }
                        }
                        
                        data[idx] = r / count;
                        data[idx + 1] = g / count;
                        data[idx + 2] = b / count;
                        data[idx + 3] = a / count;
                    }
                }
            }
        }

        // Apply blur background
        function applyBlurBackground(canvas, ctx, width, height, intensity, sensitivity) {
            // Create a copy of the original image
            const originalData = ctx.getImageData(0, 0, width, height);
            
            // Apply blur to entire image
            ctx.filter = `blur(${intensity}px)`;
            ctx.drawImage(canvas, 0, 0, width, height);
            ctx.filter = 'none';
            
            // Get the blurred image
            const blurredData = ctx.getImageData(0, 0, width, height);
            
            // Restore original foreground
            ctx.putImageData(originalData, 0, 0);
            
            // Composite: blurred background with original foreground
            const compositeData = ctx.getImageData(0, 0, width, height);
            const compData = compositeData.data;
            const blurData = blurredData.data;
            
            // Sample background color from corners
            const corners = [
                {x: 0, y: 0}, {x: width-1, y: 0},
                {x: 0, y: height-1}, {x: width-1, y: height-1}
            ];
            
            let bgR = 0, bgG = 0, bgB = 0;
            corners.forEach(corner => {
                const idx = (corner.y * width + corner.x) * 4;
                bgR += compData[idx];
                bgG += compData[idx + 1];
                bgB += compData[idx + 2];
            });
            
            bgR = Math.round(bgR / corners.length);
            bgG = Math.round(bgG / corners.length);
            bgB = Math.round(bgB / corners.length);
            
            // Blend based on background detection
            for (let i = 0; i < compData.length; i += 4) {
                const r = compData[i];
                const g = compData[i + 1];
                const b = compData[i + 2];
                
                // Calculate color difference from background
                const diff = Math.sqrt(
                    Math.pow(r - bgR, 2) +
                    Math.pow(g - bgG, 2) +
                    Math.pow(b - bgB, 2)
                ) / 441.67;
                
                // If pixel is background, use blurred version
                if (diff < sensitivity) {
                    compData[i] = blurData[i];
                    compData[i + 1] = blurData[i + 1];
                    compData[i + 2] = blurData[i + 2];
                }
            }
            
            ctx.putImageData(compositeData, 0, 0);
        }

        // Update image card with processed result
        function updateImageCard(fileName, result) {
            const card = document.querySelector(`.image-comparison-card[data-file-name="${fileName}"]`);
            if (!card) return;
            
            const processedContainer = card.querySelector('.comparison-content > div:nth-child(2) .image-container');
            const url = URL.createObjectURL(result.blob);
            
            const compressedSizeKB = (result.blob.size / 1024).toFixed(1);
            const originalFile = files.find(f => f.name === fileName);
            const compressionRatio = (result.blob.size / originalFile.size * 100).toFixed(1);
            
            // Add transparent background class if background was removed
            const bgMode = document.getElementById('bgRemovalMode').value;
            if (bgMode === 'transparent') {
                processedContainer.classList.add('transparent-bg');
            } else {
                processedContainer.classList.remove('transparent-bg');
            }
            
            processedContainer.innerHTML = `
                <img src="${url}" alt="Processed" class="image-preview">
                <div class="image-info">
                    <div class="info-top">
                        <span>${document.getElementById('outputFormat').value.toUpperCase()}</span>
                        <span>${result.width}√ó${result.height}</span>
                    </div>
                    <div class="info-bottom">
                        <span>${compressedSizeKB} KB</span>
                        <span class="compression-ratio">${compressionRatio}%</span>
                    </div>
                </div>
            `;
            
            // Update the label
            const processedLabel = card.querySelector('.comparison-content > div:nth-child(2) + div');
            if (processedLabel) {
                const bgText = bgMode !== 'none' ? ` (ƒê√£ x√≥a n·ªÅn)` : '';
                processedLabel.innerHTML = `Sau x·ª≠ l√Ω${bgText} (${compressionRatio}%)`;
            }
            
            // Clean up URL after a delay
            setTimeout(() => URL.revokeObjectURL(url), 1000);
        }

        // Download results
        async function downloadResults(outputOption) {
            if (processedImages.length === 0) return;
            
            if (outputOption === 'zip') {
                // Create zip file
                const zip = new JSZip();
                
                processedImages.forEach((img, index) => {
                    zip.file(img.name, img.blob);
                });
                
                const zipBlob = await zip.generateAsync({ type: 'blob' });
                saveAs(zipBlob, `LAZINET_Processed_Images_${Date.now()}.zip`);
                
                showNotification('ƒê√£ t·∫°o file ZIP th√†nh c√¥ng!', 'success');
            } else {
                // Download individual files
                processedImages.forEach((img, index) => {
                    setTimeout(() => {
                        saveAs(img.blob, img.name);
                    }, index * 100);
                });
                
                showNotification(`ƒê√£ b·∫Øt ƒë·∫ßu t·∫£i xu·ªëng ${processedImages.length} file!`, 'success');
            }
        }

        // Reset tool
        function resetTool() {
            Swal.fire({
                title: 'X√°c nh·∫≠n ƒë·∫∑t l·∫°i',
                text: 'B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën ƒë·∫∑t l·∫°i t·∫•t c·∫£ c√†i ƒë·∫∑t v√† x√≥a ·∫£nh ƒë√£ ch·ªçn?',
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#ff5000',
                cancelButtonColor: '#6c757d',
                confirmButtonText: 'ƒê·∫∑t l·∫°i',
                cancelButtonText: 'H·ªßy',
                reverseButtons: true
            }).then((result) => {
                if (result.isConfirmed) {
                    // Reset everything
                    files = [];
                    processedImages = [];
                    minWidth = Infinity;
                    minHeight = Infinity;
                    suggestedWidth = 1024;
                    suggestedHeight = 1024;
                    
                    // Clear inputs
                    document.getElementById('fileInput').value = '';
                    document.getElementById('folderInput').value = '';
                    
                    // Reset UI
                    document.getElementById('previewGrid').innerHTML = `
                        <div class="empty-state" style="text-align: center; padding: 40px; opacity: 0.7;">
                            <div style="font-size: 48px; margin-bottom: 20px;">üìÅ</div>
                            <div style="font-size: 1.1em; margin-bottom: 10px;">Ch∆∞a c√≥ ·∫£nh n√†o ƒë∆∞·ª£c ch·ªçn</div>
                            <div style="font-size: 0.9em;">H√£y ch·ªçn file ·∫£nh ho·∫∑c th∆∞ m·ª•c ƒë·ªÉ b·∫Øt ƒë·∫ßu</div>
                        </div>
                    `;
                    
                    document.getElementById('fileCount').textContent = '0 ·∫£nh ƒë√£ ch·ªçn';
                    document.getElementById('progressContainer').style.display = 'none';
                    document.getElementById('statsPanel').style.display = 'none';
                    document.getElementById('processingStatus').style.display = 'none';
                    document.getElementById('processBtn').disabled = true;
                    
                    // Reset controls
                    document.querySelector('input[name="resizeOption"][value="0"]').checked = true;
                    updateRadioButtons();
                    updateSizeInput();
                    
                    document.getElementById('targetSize').value = '1024';
                    document.getElementById('resampleMethod').value = 'lanczos';
                    document.getElementById('enhanceMode').value = 'none';
                    document.getElementById('outputFormat').value = 'webp';
                    document.getElementById('quality').value = '80';
                    updateQualityValue();
                    
                    // Reset background removal
                    document.getElementById('bgRemovalMode').value = 'none';
                    updateBgRemovalOptions();
                    document.getElementById('bgCustomColor').value = '#FFFFFF';
                    document.getElementById('bgBlurIntensity').value = '5';
                    document.getElementById('bgGradientColor1').value = '#FF0000';
                    document.getElementById('bgGradientColor2').value = '#0000FF';
                    document.getElementById('edgeSmoothing').checked = true;
                    document.getElementById('bgSensitivity').value = '5';
                    
                    document.querySelector('input[name="outputOption"][value="individual"]').checked = true;
                    
                    // Hide error
                    document.getElementById('uploadError').style.display = 'none';
                    
                    Swal.fire('ƒê√£ ƒë·∫∑t l·∫°i!', 'T·∫•t c·∫£ c√†i ƒë·∫∑t ƒë√£ ƒë∆∞·ª£c ƒë·∫∑t v·ªÅ m·∫∑c ƒë·ªãnh.', 'success');
                }
            });
        }

        // Show error message
        function showError(message) {
            const errorEl = document.getElementById('uploadError');
            errorEl.textContent = message;
            errorEl.style.display = 'block';
            errorEl.style.color = 'var(--error-color)';
        }

        // Show notification
        function showNotification(message, type = 'success') {
            let icon = '‚úÖ';
            let title = 'Th√†nh c√¥ng';
            
            switch (type) {
                case 'error':
                    icon = '‚ùå';
                    title = 'L·ªói';
                    break;
                case 'warning':
                    icon = '‚ö†Ô∏è';
                    title = 'C·∫£nh b√°o';
                    break;
                case 'info':
                    icon = '‚ÑπÔ∏è';
                    title = 'Th√¥ng tin';
                    break;
            }
            
            Swal.fire({
                title: title,
                html: `<div style="display: flex; align-items: center; gap: 10px;">
                    <div style="font-size: 24px;">${icon}</div>
                    <div>${message}</div>
                </div>`,
                timer: 3000,
                showConfirmButton: false,
                toast: true,
                position: 'top-end'
            });
        }
    </script>
</body>
</html>