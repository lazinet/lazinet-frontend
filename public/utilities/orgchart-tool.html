<html lang="vi-VN">

<head>
	<!-- Meta -->
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

    <!-- === CORE META TAGS === -->
    <title>Công cụ Sơ đồ Tổ chức - LAZINET | Giải pháp AI, IoT, ERP, MES</title>
    <meta name="description" content="Công cụ sơ đồ tổ chức miễn phí từ LAZINET: Tạo, chỉnh sửa và xuất sơ đồ tổ chức doanh nghiệp với dữ liệu Excel/JSON. Hỗ trợ tùy chỉnh, import/export dễ dàng.">
    <meta name="keywords" content="LAZINET, sơ đồ tổ chức, org chart tool, công cụ miễn phí, Excel import, JSON export, digital tools, organizational chart">
    <meta name="author" content="LAZINET Technologies">
    <meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
    <meta name="googlebot" content="index, follow">
    
    <!-- === CANONICAL & ALTERNATE URLs === -->
    <link rel="canonical" href="https://lazinet.com/utilities/orgchart.html">
    <link rel="alternate" hreflang="vi-VN" href="https://lazinet.com/utilities/orgchart.html">
    <link rel="alternate" hreflang="x-default" href="https://lazinet.com/utilities/orgchart.html">
    
    <!-- === FAVICON & APP ICONS === -->
    <link rel="icon" type="image/x-icon" href="../assets/img/logo-lazinet/lazinet_LogoOnly.ico">
    <link rel="icon" type="image/png" sizes="32x32" href="../assets/img/logo-lazinet/lazinet_LogoOnly.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../assets/img/logo-lazinet/lazinet_LogoOnly.png">
    <link rel="apple-touch-icon" sizes="180x180" href="../assets/img/logo-lazinet/lazinet_LogoOnly.png">
    <link rel="apple-touch-icon" sizes="120x120" href="../assets/img/logo-lazinet/lazinet_LogoOnly.png">
    <link rel="apple-touch-icon" sizes="76x76" href="../assets/img/logo-lazinet/lazinet_LogoOnly.png">
    <link rel="apple-touch-icon" sizes="60x60" href="../assets/img/logo-lazinet/lazinet_LogoOnly.png">
    
    <!-- === OPEN GRAPH (Facebook, LinkedIn) === -->
    <meta property="og:title" content="Công cụ Sơ đồ Tổ chức - LAZINET">
    <meta property="og:description" content="Công cụ miễn phí tạo sơ đồ tổ chức doanh nghiệp: Import Excel, chỉnh sửa trực quan, xuất JSON/PNG/SVG. Tư vấn 1:1, Demo trải nghiệm, hỗ trợ 24/7.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://lazinet.com/utilities/orgchart.html">
    <meta property="og:image" content="https://lazinet.com/assets/img/logo-lazinet/lazinet_logoFullSquare2.png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:image:alt" content="Công cụ Sơ đồ Tổ chức - LAZINET">
    <meta property="og:site_name" content="LAZINET">
    <meta property="og:locale" content="vi_VN">
    
    <!-- === TWITTER CARD === -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Công cụ Sơ đồ Tổ chức - LAZINET">
    <meta name="twitter:description" content="Công cụ miễn phí từ LAZINET: Tạo sơ đồ tổ chức với dữ liệu Excel/JSON, tùy chỉnh và xuất file.">
    <meta name="twitter:image" content="https://lazinet.com/assets/img/logo-lazinet/lazinet_logoFullSquare2.png">
    <meta name="twitter:image:alt" content="Công cụ Sơ đồ Tổ chức - LAZINET">
    <meta name="twitter:site" content="@lazinet">
    <meta name="twitter:creator" content="@lazinet">
    
    <!-- === ZALO SPECIFIC === -->
    <meta property="og:image:type" content="image/png">
    <meta property="og:image:secure_url" content="https://lazinet.com/assets/img/logo-lazinet/lazinet_logoFullSquare2.png">
    
    <!-- === TIKTOK SPECIFIC === -->
    <meta property="al:ios:url" content="lazinet://app">
    <meta property="al:ios:app_store_id" content="123456789">
    <meta property="al:ios:app_name" content="LAZINET">
    <meta property="al:android:url" content="lazinet://app">
    <meta property="al:android:package" content="com.lazinet.app">
    <meta property="al:android:app_name" content="LAZINET">
    
    <!-- === ADDITIONAL SEO META === -->
    <meta name="theme-color" content="#0052FF">
    <meta name="msapplication-TileColor" content="#0052FF">
    <meta name="msapplication-config" content="browserconfig.xml">
    <meta name="apple-mobile-web-app-title" content="LAZINET">
    <meta name="application-name" content="LAZINET">
    <meta name="format-detection" content="telephone=no">
    
    <!-- === STRUCTURED DATA (JSON-LD) === -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Organization",
        "name": "LAZINET",
        "alternateName": "LAZINET Technologies",
        "url": "https://lazinet.com",
        "logo": "https://lazinet.com/assets/img/logo-lazinet/lazinet_LogoFullv2.png",
        "description": "Đối tác chuyển đổi số toàn diện cung cấp giải pháp AI, IoT, ERP, MES, CRM tùy chỉnh cho doanh nghiệp",
        "address": {
            "@type": "PostalAddress",
            "streetAddress": "89 Phan Dinh Phung",
            "addressLocality": "Ho Chi Minh City",
            "addressRegion": "HCMC",
            "postalCode": "700000",
            "addressCountry": "VN"
        },
        "contactPoint": {
            "@type": "ContactPoint",
            "telephone": "+84-908556220",
            "contactType": "customer service",
            "email": "email@lazinet.com",
            "availableLanguage": "Vietnamese"
        },
        "sameAs": [
            "https://www.facebook.com/profile.php?id=61567050494124",
            "https://linkedin.com/company/lazinet"
        ]
    }
    </script>
    
    <!-- === PRELOAD CRITICAL RESOURCES === -->
    <link rel="preload" href="../assets/img/logo-lazinet/lazinet_LogoFullv2.png" as="image">
    
    <!-- === CSS FILES from OLD LAZINET === -->
    <link rel="stylesheet" href="../assets/vendor/bootstrap-icons/bootstrap-icons.css">
    <link rel="stylesheet" href="../assets/vendor/aos/aos.css">
    <link rel="stylesheet" href="../assets/vendor/glightbox/css/glightbox.min.css">
    <link rel="stylesheet" href="../assets/vendor/swiper/swiper-bundle.min.css">

	<!-- === CSS FILES from NEW LAZINET === -->
	<link rel="preconnect" href="https://fonts.googleapis.com/">
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Geist:wght@300..700&family=Instrument+Sans:wght@400..700&display=swap">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Sora:wght@100..800&amp;display=swap">
	<link rel="stylesheet" href="../assets/css/bootstrap.min.css" media="screen">
	<link rel="stylesheet" href="../assets/css/slicknav.min.css">
	<link rel="stylesheet" href="../assets/css/swiper-bundle.min.css">
	<link rel="stylesheet" href="../assets/css/all.min.css" media="screen">
	<link rel="stylesheet" href="../assets/css/animate.css">
	<link rel="stylesheet" href="../assets/css/magnific-popup.css">
	<link rel="stylesheet" href="../assets/css/mousecursor.css">
	<link rel="stylesheet" href="../assets/css/custom.css" media="screen">
    <link rel="stylesheet" href="../assets/css/lazinet.css">

    <!-- GoJS CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gojs@2.3.10/assets/css/style.min.css" />
    <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">

    <!-- Custom Styles for Org Chart Tool (Adapted to LAZINET theme) -->
    <style>
        body {
            font-family: 'Geist', 'Open Sans', sans-serif;
            background: var(--accent-secondary-color);
        }
        h2 {
            text-align: center;
        }
        /* .background-div {
            height: 90vh;
            background: linear-gradient(to top, var(--orange-light), white);
            border: solid 3px var(--orange-main);
        } */
        #container {
            display: flex;
            align-items: center;
        }
        .main-text {
            color: white;
            margin-top: 30px;
        }
        .gradient-text {
            background: linear-gradient(to right, #0052FF, #1976D2);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            display: inline;
            padding: 10px;
        }
        #downloadLinkContainer,
        #toggleButton {
            padding: 10px;
        }
        /* Table styles adapted to LAZINET blue theme */
        table {
            font-family: 'Geist', Arial, sans-serif;
            margin-bottom: 20px;
            color: var(--accent-secondary-color);
            width: 100%;
        }
        th {
            background: linear-gradient(to bottom, #0052FF, #1976D2);
            text-align: left;
            padding: 10px;
            border: 1px solid #BBDEFB;
            color: #FFFFFF;
            font-weight: bold;
        }
        tr:nth-child(even) {
            background-color: #F5F5F5;
        }
        tr:nth-child(odd) {
            background-color: #FFFFFF;
        }
        td {
            padding: 10px;
            border: 1px solid #BBDEFB;
        }
        tr:hover {
            background-color: #E3F2FD;
        }
        input[type="file"],
        button {
            background: linear-gradient(to bottom, #0052FF, #1976D2);
            color: #fff;
            padding: 10px 20px;
            border: none;
            cursor: pointer;
        }
        button:hover {
            background: linear-gradient(to bottom, #1976D2, #0052FF);
        }
        #myDiagramDiv {
            width: 100%;
            height: 80vmin; /* 90% của giá trị nhỏ hơn giữa vh và vw */
            min-height: 400px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            position: relative;
            overflow: hidden;
            background: linear-gradient(to top, var(--orange-light), white);
            border: solid 3px var(--orange-main);
        }
        textarea{
          background: var(--accent-secondary-color)
        }
    </style>


  <script lang="javascript" src="https://cdn.sheetjs.com/xlsx-0.20.0/package/dist/xlsx.full.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>


</head>

<body>
  <div
    style="position: absolute; top: 28px; left: 28px; width: 200px; height: 70px; background-color: white; border-radius: 10px; z-index: 9999;">
    <img src="../assets/img/logo-lazinet/lazinet_LogoFullv2_vi.png" alt="LAZINET's Logo">
  </div>


  <!-- <script src="../Configs/go.js"></script> -->
  <script src="https://cdn.jsdelivr.net/npm/gojs@2.3.10/release/go.min.js"></script>

  <div id="allSampleContent" class="p-4 w-full">

    <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gojs@2.3.10/extensions/DataInspector.css" /> -->
    <script src="https://cdn.jsdelivr.net/npm/gojs@2.3.10/extensions/DataInspector.js"></script>


    <script id="code">
      let myDiagram;

      function init() {

        // Since 2.2 you can also author concise templates with method chaining instead of GraphObject.make
        // For details, see https://gojs.net/latest/intro/buildingObjects.html
        const $ = go.GraphObject.make;  // for conciseness in defining templates

        myDiagram =
          new go.Diagram("myDiagramDiv", // must be the ID or reference to div
            {
              allowCopy: false,
              allowDelete: false,
              //initialAutoScale: go.Diagram.Uniform,
              maxSelectionCount: 1, // users can select only one part at a time
              validCycle: go.Diagram.CycleDestinationTree, // make sure users can only create trees
              "clickCreatingTool.archetypeNodeData": { // allow double-click in background to create a new node
                Full_Name: "Nhân viên",
                Professional_Title: "",
                Department_Team: "",
                Lead_Title: "",
                parent: "",
                Portrait_URL: "",
                Profile_URL: "",
                Remarks: ""
              },
              "clickCreatingTool.insertPart": function (loc) {  // method override must be function, not =>
                const node = go.ClickCreatingTool.prototype.insertPart.call(this, loc);
                if (node !== null) {
                  this.diagram.select(node);
                  this.diagram.commandHandler.scrollToPart(node);
                  this.diagram.commandHandler.editTextBlock(node.findObject("NAMETB"));
                }
                return node;
              },
              layout:
                $(go.TreeLayout,
                  {
                    treeStyle: go.TreeLayout.StyleLastParents,
                    arrangement: go.TreeLayout.ArrangementHorizontal,
                    // properties for most of the tree:
                    angle: 90,
                    layerSpacing: 35,
                    // properties for the "last parents":
                    alternateAngle: 90,
                    alternateLayerSpacing: 35,
                    alternateAlignment: go.TreeLayout.AlignmentBus,
                    alternateNodeSpacing: 20
                  }),
              "undoManager.isEnabled": true // enable undo & redo
            });

        // when the document is modified, add a "*" to the Professional_Title and enable the "Save" button
        myDiagram.addDiagramListener("Modified", e => {
          const button = document.getElementById("SaveButton");
          if (button) button.disabled = !myDiagram.isModified;
          const idx = document.title.indexOf("*");
          if (myDiagram.isModified) {
            if (idx < 0) document.title += "*";
          } else {
            if (idx >= 0) document.title = document.title.slice(0, idx);
          }
        });

        // const levelColors = ["#AC193D", "#2672EC", "#8C0095", "#5133AB", "#008299", "#D24726", "#008A00", "#094AB2"];
        const levelColors = ["#FF0000", "#FFA500", "#FFFF00", "#00FF00", "#0000FF", "#FFC0CB", "#FFFFFF", "#808080"];
        //   Red: #FF0000
        // Green: #00FF00
        // Blue: #0000FF
        // Yellow: #FFFF00
        // Purple: #800080
        // Orange: #FFA500
        // Pink: #FFC0CB
        // Brown: #A52A2A
        // Black: #000000
        // White: #FFFFFF
        // Gray: #808080

        // override TreeLayout.commitNodes to also modify the background brush based on the tree depth level
        myDiagram.layout.commitNodes = function () {  // method override must be function, not =>
          go.TreeLayout.prototype.commitNodes.call(this);  // do the standard behavior
          // then go through all of the vertexes and set their corresponding node's Shape.fill
          // to a brush dependent on the TreeVertex.level value
          myDiagram.layout.network.vertexes.each(v => {
            if (v.node) {
              const level = v.level % (levelColors.length);
              const color = levelColors[level];
              const shape = v.node.findObject("SHAPE");
              if (shape) shape.stroke = $(go.Brush, "Linear", { 0: color, 1: go.Brush.lightenBy(color, 0.05), start: go.Spot.Left, end: go.Spot.Right });
            }
          });
        };

        // this is used to determine feedback during drags
        function mayWorkFor(node1, node2) {
          if (!(node1 instanceof go.Node)) return false;  // must be a Node
          if (node1 === node2) return false;  // cannot work for yourself
          if (node2.isInTreeOf(node1)) return false;  // cannot work for someone who works for you
          return true;
        }

        // This function provides a common style for most of the TextBlocks.
        // Some of these values may be overridden in a particular TextBlock.
        function textStyle() {
          return { font: "9pt  Segoe UI,sans-serif", stroke: "white" };
        }

        // This converter is used by the Portrait Picture.
        function findHeadShot(Portrait_URL) {
          return Portrait_URL || "https://cdn-icons-png.flaticon.com/128/4122/4122823.png";
        }

        // define the Node template
        myDiagram.nodeTemplate =
          $(go.Node, "Spot",
            {
              selectionObjectName: "BODY",
              mouseEnter: (e, node) => node.findObject("BUTTON").opacity = node.findObject("BUTTONX").opacity = 1,
              mouseLeave: (e, node) => node.findObject("BUTTON").opacity = node.findObject("BUTTONX").opacity = 0,
              // handle dragging a Node onto a Node to (maybe) change the reporting relationship
              mouseDragEnter: (e, node, prev) => {
                const diagram = node.diagram;
                const selnode = diagram.selection.first();
                if (!mayWorkFor(selnode, node)) return;
                const shape = node.findObject("SHAPE");
                if (shape) {
                  shape._prevFill = shape.fill;  // remember the original brush
                  shape.fill = "darkred";
                }
              },
              mouseDragLeave: (e, node, next) => {
                const shape = node.findObject("SHAPE");
                if (shape && shape._prevFill) {
                  shape.fill = shape._prevFill;  // restore the original brush
                }
              },
              mouseDrop: (e, node) => {
                const diagram = node.diagram;
                const selnode = diagram.selection.first();  // assume just one Node in selection
                if (mayWorkFor(selnode, node)) {
                  // find any existing link into the selected node
                  const link = selnode.findTreeParentLink();
                  if (link !== null) {  // reconnect any existing link
                    link.fromNode = node;
                  } else {  // else create a new link
                    diagram.toolManager.linkingTool.insertLink(node, node.port, selnode, selnode.port);
                  }
                }
              }
            },
            // for sorting, have the Node.text be the data.Full_Name
            new go.Binding("text", "Full_Name"),
            // bind the Part.layerName to control the Node's layer depending on whether it isSelected
            new go.Binding("layerName", "isSelected", sel => sel ? "Foreground" : "").ofObject(),
            $(go.Panel, "Auto",
              { name: "BODY" },
              // define the node's outer shape
              $(go.Shape, "Rectangle",
                { name: "SHAPE", fill: "#0070C0", stroke: 'white', strokeWidth: 3.5, portId: "" }), // Thay đổi màu nền của node ở đây 1e6847 "linear-gradient(to top, #a8d7c9, #6db1d1)"
              $(go.Panel, "Horizontal",
                $(go.Picture,
                  {
                    name: "Picture",
                    desiredSize: new go.Size(70, 70),
                    margin: 1.5,
                    source: "https://cdn-icons-png.flaticon.com/128/4122/4122823.png" // the default image
                  },
                  new go.Binding("source", "Portrait_URL", findHeadShot)),

                // define the panel where the text will appear
                $(go.Panel, "Table",
                  {
                    minSize: new go.Size(130, NaN),
                    maxSize: new go.Size(150, NaN),
                    margin: new go.Margin(6, 10, 0, 6),
                    defaultAlignment: go.Spot.Left
                  },
                  $(go.RowColumnDefinition, { column: 2, width: 4 }),

                  // Trường Full_Name
                  $(go.TextBlock, textStyle(),  // the name
                    {
                      name: "NAMETB",
                      row: 0, column: 0, columnSpan: 5,
                      font: "bold 11pt Segoe UI,sans-serif",
                      editable: true, isMultiline: false,
                      minSize: new go.Size(50, 16),
                      click: function (e, tb) {
                        const node = tb.part;
                        const Profile_URL = node.data.Profile_URL;
                        if (Profile_URL) {
                          window.open(Profile_URL, "_blank");
                        }
                      }
                    },
                    new go.Binding("text", "Full_Name").makeTwoWay()),

                  // Trường Professional
                  $(go.TextBlock, textStyle(),
                    {
                      row: 1, column: 0, columnSpan: 4,
                      editable: true, isMultiline: false,
                      minSize: new go.Size(50, 14),
                      // margin: new go.Margin(0, 0, 0, 0)
                    },
                    new go.Binding("text", "Professional_Title").makeTwoWay()),

                  $(go.TextBlock, textStyle(),  // Chỉ hiển thị
                    {
                      row: 2, column: 0, columnSpan: 5,
                      font: "italic 8pt Segoe UI,sans-serif",
                      wrap: go.TextBlock.WrapFit,
                      editable: true,  // by default newlines are allowed
                      minSize: new go.Size(100, 14)
                    },
                    new go.Binding("text", function (node) {
                      // Kiểm tra nếu trường "Lead_Title" không trống
                      if (node.data.Lead_Title !== "") {
                        // Trả về giá trị của trường "Lead_Title"                  
                        return node.data.Lead_Title;
                      } else {
                        // Trả về giá trị của trường "Department_Team"
                        return node.data.Department_Team;
                      }
                    }).ofObject()
                  ),
                ) // end Table Panel
              ) // end Horizontal Panel
            ), // end Auto Panel
            $("Button",
              $(go.Shape, "PlusLine", { width: 10, height: 10 }),
              {
                name: "BUTTON", alignment: go.Spot.Right, opacity: 0,  // initially not visible
                click: (e, button) => addEmployee(button.part)
              },
              // button is visible either when node is selected or on mouse-over
              new go.Binding("opacity", "isSelected", s => s ? 1 : 0).ofObject()
            ),
            new go.Binding("isTreeExpanded").makeTwoWay(),
            $("TreeExpanderButton",
              {
                name: "BUTTONX", alignment: go.Spot.Bottom, opacity: 0,  // initially not visible
                "_treeExpandedFigure": "TriangleUp",
                "_treeCollapsedFigure": "TriangleDown"
              },
              // button is visible either when node is selected or on mouse-over
              new go.Binding("opacity", "isSelected", s => s ? 1 : 0).ofObject()
            )
          );  // end Node, a Spot Panel

        function addEmployee(node) {
          if (!node) return;
          const thisemp = node.data;
          myDiagram.startTransaction("add employee");
          const newemp = {
            Full_Name: "Nhân viên", Professional_Title: "Professional_Title", Department_Team: "", Lead_Title: "if Lead",
            Portrait_URL: "https://cdn-icons-png.flaticon.com/128/4122/4122823.png", Profile_URL: "", Remarks: "", parent: thisemp.key
          };
          // https://us.123rf.com/450wm/saryuuu10/saryuuu102305/saryuuu10230500153/204225961-simple-biometric-or-facial-recognition-icon-editable-vector.jpg
          // https://cdn.vectorstock.com/i/1000x1000/82/68/manager-business-people-icon-with-blue-duotone-vector-46998268.webp
          // https://cdn.pixabay.com/photo/2016/08/08/09/17/avatar-1577909_1280.png
          // https://cdn-icons-png.flaticon.com/128/6097/6097268.png
          // https://cdn-icons-png.flaticon.com/128/7134/7134949.png
          // https://cdn-icons-png.flaticon.com/128/4122/4122823.png
          // https://cdn-icons-png.flaticon.com/128/8426/8426240.png
          // https://cdn-icons-png.flaticon.com/128/4997/4997721.png
          // https://cdn-icons-png.flaticon.com/128/3607/3607426.png
          myDiagram.model.addNodeData(newemp);
          const newnode = myDiagram.findNodeForData(newemp);
          if (newnode) newnode.location = node.location;
          myDiagram.commitTransaction("add employee");
          myDiagram.commandHandler.scrollToPart(newnode);
        }

        // the context menu allows users to make a position vacant,
        // remove a role and reassign the subtree, or remove a Department_Team
        myDiagram.nodeTemplate.contextMenu =
          $("ContextMenu",
            $("ContextMenuButton",
              $(go.TextBlock, "Add Employee"),
              {
                click: (e, button) => addEmployee(button.part.adornedPart)
              }
            ),
            $("ContextMenuButton",
              $(go.TextBlock, "Vacate Position"),
              {
                click: (e, button) => {
                  const node = button.part.adornedPart;
                  if (node !== null) {
                    const thisemp = node.data;
                    myDiagram.startTransaction("vacate");
                    // update the key, Full_Name, picture, and Remarks, but leave the Professional_Title
                    myDiagram.model.setDataProperty(thisemp, "Full_Name", "(Vacant)");
                    myDiagram.model.setDataProperty(thisemp, "Portrait_URL", "");
                    myDiagram.model.setDataProperty(thisemp, "Remarks", "");
                    myDiagram.commitTransaction("vacate");
                  }
                }
              }
            ),
            $("ContextMenuButton",
              $(go.TextBlock, "Remove Role"),
              {
                click: (e, button) => {
                  // reparent the subtree to this node's boss, then remove the node
                  const node = button.part.adornedPart;
                  if (node !== null) {
                    myDiagram.startTransaction("reparent remove");
                    const chl = node.findTreeChildrenNodes();
                    // iterate through the children and set their parent key to our selected node's parent key
                    while (chl.next()) {
                      const emp = chl.value;
                      myDiagram.model.setParentKeyForNodeData(emp.data, node.findTreeParentNode().data.key);
                    }
                    // and now remove the selected node itself
                    myDiagram.model.removeNodeData(node.data);
                    myDiagram.commitTransaction("reparent remove");
                  }
                }
              }
            ),
            $("ContextMenuButton",
              $(go.TextBlock, "Remove Department_Team"),
              {
                click: (e, button) => {
                  // remove the whole subtree, including the node itself
                  const node = button.part.adornedPart;
                  if (node !== null) {
                    myDiagram.startTransaction("remove dept");
                    myDiagram.removeParts(node.findTreeParts());
                    myDiagram.commitTransaction("remove dept");
                  }
                }
              }
            )
          );

        // define the Link template
        myDiagram.linkTemplate =
          $(go.Link, go.Link.Orthogonal,
            { layerName: "Background", corner: 5 },
            $(go.Shape, { strokeWidth: 2, stroke: "#19658F" }));  // the link shape

        // read in the JSON-format data from the "mySavedModel" element
        load();

        // support editing the properties of the selected person in HTML
        if (window.Inspector) myInspector = new Inspector("myInspector", myDiagram,
          {
            properties: {
              "key": { readOnly: true },
              // "Remarks": {}
            }
          });

        // Căn chỉnh tự động
        document.getElementById('zoomToFit').addEventListener('click', () => myDiagram.commandHandler.zoomToFit());

        document.getElementById('centerRoot').addEventListener('click', () => {
          myDiagram.scale = 1;
          myDiagram.commandHandler.scrollToPart(myDiagram.findNodeForKey(1));
        });

        // Lắng nghe xử lý duyệt file Excel
        document.getElementById('excelFile').addEventListener('change', handleFile);

        // Lắng nghe chuột xuất hình
        // document.getElementById("exportToPNG").addEventListener("click", exportTransparentPNG);
        document.getElementById("exportToSVG").addEventListener("click", makeSvgWithEmbeddedImages);
        
        // Hoặc sử dụng sự kiện diagram đã khởi tạo xong
        myDiagram.addDiagramListener("InitialLayoutCompleted", function(e) {
          const diagram = e.diagram;
          
          // 1. Zoom to fit
          diagram.zoomToFit();

          // 2. Căn giữa dọc (nếu cần)
          const viewBounds = diagram.viewportBounds;
          const docBounds = diagram.documentBounds;

          if (docBounds.height < viewBounds.height) {
            const padding = (viewBounds.height - docBounds.height) / 2;
            diagram.scrollToRect(new go.Rect(  // <-- Sửa thành go.Rect
              docBounds.x,
              docBounds.y - padding,
              docBounds.width,
              docBounds.height + padding * 2
            ));
          }

          // 3. Giới hạn phóng to (tùy chọn)
          if (diagram.scale > 1) {
            diagram.scale = 1;
          }
        });
      } // Kế thúc hàm init

      function myCallbackPNG(blob) {
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = `orgchart_${new Date().getTime()}.png`; // Tên file tự động
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url); // Giải phóng bộ nhớ
      }

      function makeBlobPNG() {
        myDiagram.zoomToFit();
        var blob = myDiagram.makeImageData({ background: "transparent", returnType: "blob", callback: myCallbackPNG });
      }

      async function exportTransparentPNG() {
        // 1. Tạo bản sao của diagram để không ảnh hưởng đến dữ liệu gốc
        const diagramCopy = myDiagram.clone();

        // 2. Thay thế URL ảnh chân dung bằng Base64
        const nodes = diagramCopy.model.nodeDataArray;
        for (const node of nodes) {
          if (node.Portrait_URL) {
            try {
              node.Portrait_URL = await fetchImageAsBase64(node.Portrait_URL);
            } catch (error) {
              console.error("Lỗi tải ảnh:", node.Portrait_URL, error);
              // Dùng ảnh mặc định nếu có lỗi
              node.Portrait_URL = "https://cdn-icons-png.flaticon.com/128/4122/4122823.png";
            }
          }
        }

        // 3. Xuất PNG với nền trong suốt
        diagramCopy.zoomToFit();
        var blob = diagramCopy.makeImageData({
          scale: 4, // Tăng scale để ảnh sắc nét
          background: "transparent", // Nền trong suốt
          returnType: "blob",
          callback: myCallbackPNG
        });
        
      }

      // Ảnh svg
      function myCallback(blob) {
        var url = window.URL.createObjectURL(blob);
        var filename = "LAZINET OrgChartV2 " + timeNow() + ".svg";

        var a = document.createElement("a");
        a.style = "display: none";
        a.href = url;
        a.download = filename;

        // IE 11
        if (window.navigator.msSaveBlob !== undefined) {
          window.navigator.msSaveBlob(blob, filename);
          return;
        }

        document.body.appendChild(a);
        requestAnimationFrame(() => {
          a.click();
          window.URL.revokeObjectURL(url);
          document.body.removeChild(a);
        });
      }

      function makeSvg() {
        var svg = myDiagram.makeSvg({ scale: 1, background: "transparent" });
        var svgstr = new XMLSerializer().serializeToString(svg);
        var blob = new Blob([svgstr], { type: "image/svg+xml" });
        myCallback(blob);
      }

      async function makeSvgWithEmbeddedImages() {
        // Bước 1: Thu thập tất cả URL ảnh chân dung từ dữ liệu diagram
        const imageUrls = [];
        myDiagram.model.nodeDataArray.forEach(node => {
          if (node.Portrait_URL) imageUrls.push(node.Portrait_URL);
        });

        // Bước 2: Tải ảnh và chuyển đổi sang Base64
        const imageBase64Map = {};
        for (const url of imageUrls) {
          const base64 = await fetchImageAsBase64(url);
          imageBase64Map[url] = base64;
        }

        // Bước 3: Tạo SVG và thay thế URL bằng Base64
        var svg = myDiagram.makeSvg({ scale: 1, background: "white" });
        var svgstr = new XMLSerializer().serializeToString(svg);

        for (const [url, base64] of Object.entries(imageBase64Map)) {
          svgstr = svgstr.replace(new RegExp(url, 'g'), base64);
        }

        // Bước 4: Xuất file
        var blob = new Blob([svgstr], { type: "image/svg+xml" });
        myCallback(blob);
      }

      // Hàm hỗ trợ: Tải ảnh và trả về Base64
      function fetchImageAsBase64(url) {
        return fetch(url)
          .then(response => response.blob())
          .then(blob => new Promise((resolve) => {
            const reader = new FileReader();
            reader.onload = () => resolve(reader.result);
            reader.readAsDataURL(blob);
          }));
      }

        /**
       * Chuyển đổi SVG từ URL thành PNG và tải xuống
       * @param {string} svgUrl - URL của file SVG cần chuyển đổi
       * @param {string} [fileName='converted'] - Tên file khi tải xuống (không cần đuôi .png)
       */
      async function convertSvgUrlToPng(svgUrl, fileName = 'converted') {
        try {
          // 1. Tải nội dung SVG
          const response = await fetch(svgUrl);
          if (!response.ok) throw new Error(`Lỗi tải SVG: ${response.status}`);
          const svgText = await response.text();

          // 2. Tạo image element từ SVG
          const img = await createImageFromSvg(svgText);
          
          // 3. Vẽ SVG lên canvas và xuất PNG
          const pngBlob = await renderToPng(img);
          
          // 4. Tải xuống file PNG
          downloadBlob(pngBlob, `${fileName}.png`);
          
          return true;
        } catch (error) {
          console.error('Lỗi chuyển đổi SVG sang PNG:', error);
          throw error; // Có thể bỏ qua nếu muốn tự xử lý lỗi
        }
      }

      // Hàm hỗ trợ: Tạo Image từ SVG text
      function createImageFromSvg(svgText) {
        return new Promise((resolve, reject) => {
          const img = new Image();
          const svgBlob = new Blob([svgText], { type: 'image/svg+xml' });
          const url = URL.createObjectURL(svgBlob);

          img.onload = () => {
            URL.revokeObjectURL(url);
            resolve(img);
          };
          img.onerror = (err) => {
            URL.revokeObjectURL(url);
            reject(new Error('Không thể tạo hình ảnh từ SVG'));
          };
          img.src = url;
        });
      }

      // Hàm hỗ trợ: Render Image thành PNG Blob
      function renderToPng(img) {
        return new Promise((resolve) => {
          const canvas = document.createElement('canvas');
          canvas.width = img.width;
          canvas.height = img.height;
          
          const ctx = canvas.getContext('2d');
          ctx.drawImage(img, 0, 0);
          
          canvas.toBlob((blob) => {
            resolve(blob);
          }, 'image/png');
        });
      }

      // Hàm hỗ trợ: Tải xuống Blob
      function downloadBlob(blob, fileName) {
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = fileName;
        document.body.appendChild(a);
        a.click();
        setTimeout(() => {
          document.body.removeChild(a);
          URL.revokeObjectURL(url);
        }, 100);
      }


      // Show the diagram's model in JSON format
      function save() {
        document.getElementById("mySavedModel").value = myDiagram.model.toJson();
        myDiagram.isModified = false;
      }
      function load() {
        myDiagram.model = go.Model.fromJson(document.getElementById("mySavedModel").value);
        // make sure new data keys are unique positive integers
        let lastkey = 1;
        myDiagram.model.makeUniqueKeyFunction = (model, data) => {
          let k = data.key || lastkey;
          while (model.findNodeDataForKey(k)) k++;
          data.key = lastkey = k;
          return k;
        };
      }

      function timeNow() {
        var currentTime = new Date();

        // Định dạng thời gian
        var year = currentTime.getFullYear();
        var month = ('0' + (currentTime.getMonth() + 1)).slice(-2);
        var day = ('0' + currentTime.getDate()).slice(-2);
        var hours = ('0' + currentTime.getHours()).slice(-2);
        var minutes = ('0' + currentTime.getMinutes()).slice(-2);
        var seconds = ('0' + currentTime.getSeconds()).slice(-2);

        // Tạo chuỗi định dạng yyyyMMMdd_hhmmss
        var formattedTime = year + month + day + '_' + hours + minutes + seconds;
        return formattedTime;

      }

      // Hàm xử lý dữ liệu từ Excel
      function handleFile() {
        const fileInput = document.getElementById('excelFile');
        const file = fileInput.files[0];

        const reader = new FileReader();
        reader.onload = function (event) {
          const data = new Uint8Array(event.target.result);
          const workbook = XLSX.read(data, { type: 'array' });

          const firstSheetName = workbook.SheetNames[0];
          const worksheet = workbook.Sheets[firstSheetName];

          const userBgColor = ('C5' in worksheet) ? worksheet['C5'].v : '#ffffff'; // Màu nền mặc định nếu không set
          const userBgUrl = ('C6' in worksheet) ? worksheet['C6'].v : '';
          // const userDefaultPhotoUrl = ('C7' in worksheet) ? worksheet['C7'].v : ''; // 

          // Cập nhật màu nền hoặc hình nền dựa trên giá trị userBgColor và userBgUrl
          const diagramDiv = document.getElementById("myDiagramDiv");
          if (userBgColor) {
            diagramDiv.style.backgroundColor = userBgColor;
          }
          else {
            diagramDiv.style.background = "linear-gradient(to top, #a8d7c9, #6db1d1)";
          }

          if (userBgUrl.trim() !== "") {
            diagramDiv.style.backgroundImage = `url(${userBgUrl})`;
            diagramDiv.style.backgroundSize = "cover"; // Hiển thị hình nền phủ đầy khung
            diagramDiv.style.backgroundRepeat = "no-repeat"; // Không lặp lại hình nền
            diagramDiv.style.backgroundPosition = "center center"; // Hiển thị hình nền ở giữa khung
          } else {
            diagramDiv.style.backgroundImage = "none";
          }

          //   if ('C7' in worksheet) {
          //   const yourDiagram = go.Diagram.fromDiv(diagramDiv);
          //   // Lấy ra tất cả các nút trong diagram
          //   const allNodes = yourDiagram.model.nodeDataArray;
          //   // Lặp qua tất cả các nút để thay đổi giá trị của thuộc tính Picture
          //   for (const node of allNodes) {
          //     if (node.Picture == undefined) {
          //       yourDiagram.model.setDataProperty(node, "Picture", worksheet['C7'].v);
          //     }
          //   }
          // }

          // Xử lý dữ liệu ở đây
          const dataXLSX = XLSX.utils.sheet_to_json(worksheet, { header: 1 }).slice(9);
          // Tìm chỉ số dòng cuối cùng có dữ liệu
          let actualEnd = 11;
          while (actualEnd < dataXLSX.length) {
            const row = dataXLSX[actualEnd];
            if (row[0] == "") { break; }
            actualEnd++;
          }

          const actualData = dataXLSX.slice(0, actualEnd);

          // Tạo tệp JSON từ dữ liệu và tạo liên kết tải xuống
          const nodeDataArray = [];
          const table = document.createElement('table');
          const headerRow = document.createElement('tr');
          const columnNames = ['Key', 'Full_Name', 'Professional_Title', 'Department_Team', 'Lead_Title', 'Supervisor_Key', 'Portrait_URL', 'Profile_URL', 'Remarks'];
          columnNames.forEach(columnName => {
            const headerCell = document.createElement('th');
            headerCell.textContent = columnName;
            headerRow.appendChild(headerCell);
          });
          table.appendChild(headerRow);

          for (let i = 1; i < dataXLSX.length; i++) {
            const row = dataXLSX[i];
            if (row[0] !== "") {
              const newNode = {
                key: i,
                Full_Name: row[1],
                Professional_Title: row[2],
                Department_Team: row[3],
                Lead_Title: row[4],
                parent: row[5],
                Portrait_URL: row[6],
                Profile_URL: row[7],
                Remarks: row[8]
              };
              // Mỗi newNode sẽ là 1 hàng của bảng luôn
              const tabRow = document.createElement('tr');
              for (let prop in newNode) {
                if (newNode.hasOwnProperty(prop)) {
                  const cell = document.createElement('td');
                  cell.textContent = newNode[prop];
                  tabRow.appendChild(cell); // Append the cell to the table row
                }
              }
              nodeDataArray.push(newNode);
              table.appendChild(tabRow);
            }
          }

          // Chuyển đổi mảng nodeDataArray thành JSON
          const newNodeDataArrayJSON = JSON.stringify({ class: "go.TreeModel", nodeDataArray });
          // Cập nhật dữ liệu trong textarea và nạp lại sơ đồ
          document.getElementById("mySavedModel").value = newNodeDataArrayJSON;
          myDiagram.model = go.Model.fromJson(newNodeDataArrayJSON);
          myDiagram.commandHandler.zoomToFit();
          load();


          // Tạo link tải xuống file text JSON
          const textJSON = new Blob([newNodeDataArrayJSON], { type: "text/plain" });
          const textJSONurl = URL.createObjectURL(textJSON);
          const downloadLink = document.createElement("a");
          downloadLink.href = textJSONurl;
          downloadLink.download = "Tệp kết quả sơ đồ tổ chức dạng text JSON từ Excel" + timeNow() + ".txt";
          downloadLink.innerHTML = "Tệp kết quả sơ đồ tổ chức dạng text JSON từ Excel";
          const downloadLinkContainer = document.getElementById("downloadLinkContainer");
          // downloadLinkContainer.innerHTML = ""; // Xóa nội dung cũ
          downloadLinkContainer.appendChild(downloadLink);

          // Nút ẩn hiện bảng dữ liệu từ Excel
          const toggleButton = document.getElementById("toggleButton");
          toggleButton.style.display = "block";
          let isTableVisible = false;
          toggleButton.addEventListener("click", () => {
            const tableContainer = document.getElementById("tableContainer");
            if (isTableVisible) {
              tableContainer.style.display = "none";
              toggleButton.textContent = "Hiển thị bảng";
            } else {
              tableContainer.style.display = "block";
              tableContainer.innerHTML = '';
              tableContainer.appendChild(table);
              toggleButton.textContent = "Ẩn bảng";
            }
            isTableVisible = !isTableVisible; // Đảo ngược kiểu công tắc
          });

        };
        reader.readAsArrayBuffer(file);

      }

      window.addEventListener('DOMContentLoaded', init);
    </script>
    <!-- // Thêm sự kiện khi tài liệu được tải
    window.addEventListener('DOMContentLoaded', (event) => {
    // Khởi tạo biểu đồ và các tương tác khác ở đây...
      init();
    });
    </script> -->

    <div id="sample">
      <!-- <div id="myDiagramDiv" class="background-div" style="background-color: #34343C; border: solid 1px black; height: 700px;"></div> -->
      <div id="myDiagramDiv" class="background-div"></div>

      <!-- <div id="myDiagramDiv" style="background-color: linear-gradient(to bottom, #a8d7c9, #6db1d1); border: solid 1px black; height: 700px;"></div> -->

      <div style="text-align: center;">
        <h3 class="main-text">CÔNG CỤ TẠO SƠ ĐỒ TỔ CHỨC LAZINET</h3>
        <div style="
          display: inline-flex;
          flex-wrap: wrap;
          justify-content: center;
          gap: 10px;
          max-width: 100%;
          margin: 10px auto;
          padding: 10px;
          box-sizing: border-box;
        ">
          <p>
            <button style="width: 210px;" id="zoomToFit">Căn vừa màn hình</button>
            <button style="width: 210px;" id="centerRoot">Căn giữa theo sếp</button>
            <button style="width: 210px;" id="exportToSVG">Xuất ảnh SVG</button>
            <!-- <button style="width: 210px;" id="exportToPNG">Xuất ảnh PNG (beta)</button> -->
            <button button style="width: 210px;" id="exportPngFromUrl">Xuất ảnh PNG</button>
              <script>
                document.getElementById('exportPngFromUrl').addEventListener('click', async () => {
                  const svgUrl = 'https://dnqt.vn/assets/img/orgchart/orgchart2.svg'; // Thay bằng URL thực tế
                  try {
                    await convertSvgUrlToPng(svgUrl, 'orgchart2');
                  } catch (error) {
                    alert('Xuất ảnh thất bại: ' + error.message);
                  }
                });
              </script>
          </p>
        </div>
      </div>

      <div>
        <h3 class="main-text"><u>HƯỚNG DẪN SỬ DỤNG</u></h3>
        <h4 class="main-text"><i>1. Chỉnh sửa từng người:</i></h4>
        <p>Hãy bấm vào 1 vị trí ở trong khung hình nhân viên và chỉnh sửa trực tiếp ngay trên đó hoặc theo bảng xuất
          hiện dưới đây:</p>
        <div id="myInspector"></div>

        <h4 class="main-text"><i>2. Cập nhật toàn bộ tổ chức:</i></h4>
        Nếu chưa có bảng dữ liệu thì hãy tải xuống
        <a href="OrgChartV2.2_LAZINET.xlsm" download> mẫu Excel </a>
        để chuẩn bị dữ liệu theo mẫu và lưu tệp lại, rồi bấm vào duyệt đến tệp đó để cập nhật sơ đồ tổ chức theo dữ liệu
        mới.
        <input type="file" id="excelFile" accept=".xlsx, .xlsm, .xls" />

        <div id="container">
          <button id="toggleButton" style="display: none">Hiển thị bảng</button>
          <p id="downloadLinkContainer"></p>
        </div>
        <div id="tableContainer"></div>

        <h4 class="main-text"><i>3. Cấu trúc dữ liệu:</i><br></h4>
        <p>
        <ul>
          <li>Cấu trúc dữ liệu phải đúng theo mẫu, cần có các trường thông tin đúng với mô tả hướng dẫn</li>
          <li>Ô C5 chứa mã màu của hình nền. Hãy bôi màu nó sau đó bấm tổ hợp phím Ctrl + Shift + M để chương trình tự
            tạo đúng mã màu đã bôi.</li>
          <li>Ô C6 chứa đường dẫn đến ảnh của hình nền cho sơ đồ tổ chức. Nếu điền thì hình nền là ưu tiên, nếu không
            thì thông tin mã màu ở ô C5 sẽ làm màu nền, nếu C5 để trống thì mã màu mặc định phong cách LAZINET sẽ làm
            màu nền.</li>
          <li>Ô C7 chứa đường dẫn đến ảnh của hình nhân mặc định, dạng vẽ biểu tượng. Nó dùng để chèn vào cho các nhân
            viên có trường ảnh chân dung (Portrait_URL) để trống.</li>
          <li>Key được hiểu như là số định danh (ID, STT) của mỗi nhân viên trong tổ chức. Key cần phải duy nhất.</li>
          <li>Full Name nên ngắn gọn để hiển thị cho đẹp vừa vặn trong khung (20 ký tự trở xuống)</li>
          <li>Professional_Title là chức danh theo chuyên môn, nên ngắn gọn để hiển thị cho đẹp vừa vặn trong khung (50
            ký tự trở xuống)</li>
          <li>Department_Team là phòng ban/ đội nhóm mà nhân viên thuộc về. Cái này chỉ là thông tin bổ sung, nếu có thì
            tốt, vì đã thể hiện qua người đứng đầu trong Lead_Title</li>
          <li>Lead_Title là chức danh của người đứng đầu một phân loại quản lý nào đó tùy ngữ cảnh cấu trúc (Văn phòng,
            Phòng ban, dự án, đội nhóm chuyên môn ...). Nhân viên nào có Lead_Title thì trường này sẽ được hiển thị. Như
            vậy thay vì bổ sung phòng ban hoặc nhóm, thì thông tin này đã phản ánh thông qua người đứng đầu.</li>
          <li>Supervisor_ID hay còn gọi là parent, tức là Key của người quản lý trực tiếp. Trong một sơ đồ tổ chức,
            thường chỉ có một quản lý cao nhất không có Supervisor_ID (tức là để trống). Nếu có nhiều hơn thì sẽ tạo ra
            các sơ đồ tổ chức độc lập với nhau.</li>
          <li>Portrait_URL là đường dẫn đến ảnh chân dung của nhân viên. Ảnh sẽ tự động được nhúng vào sơ đồ tổ chức ở
            độ phân giải chất lượng cao nhất từ ảnh nguồn. Nếu trường này bỏ trống, chân dung hình nhân mặc định sẽ được
            sử dụng. Nếu điền 1 link không tồn tại ảnh, thì hiện thị trống.</li>
          <li>Profile_URL là đường dẫn đến hồ sơ của nhân viên, nó sẽ được đính kèm vào tên của nhân viên trên sơ đồ tổ
            chức (bấm vào thì sẽ mở ra trang hồ sơ).</li>
          <li>Remarks là những ghi chú, thông tin bổ sung.</li>
        </ul>
        </p>

        <h4 class="main-text"><i>4. Mô tả chức năng & tính năng:</i><br></h4>
        <p>
        <ul>
          <li>Sơ đồ tổ chức khởi động dựa trên cấu trúc đã nạp sẵn (mặc định), người dùng có thể thay đổi trực tiếp trên
            sơ đồ, nhập liệu bảng tùy biến, tải vào bảng JSON hoặc nhập liệu từ Excel</li>
          <li>Có thể tùy biến để sử dụng cho những mô hình có cấu trúc hình cây khác nhau: Liên danh, Công ty, Phòng
            ban, Dự án, Phân nhóm/ phân loài ... Sơ đồ hoàn toàn tùy thuộc vào mối quan hệ luận lý từ bảng dữ liệu nhập
            vào.</li>
          <li>Người dùng có thể linh động sử dụng theo cách mà dữ liệu Phòng ban/ Đội nhóm là một nhân viên.</li>
          <li>Cho phép tùy biến màu nền hoặc hình nền theo thông tin dữ liệu nhập vào, phù hợp những ngữ cảnh sử dụng
            khác nhau.</li>
          <li>Trình đơn chuột phải trên mỗi nhân viên cung cấp các chức năng: Thêm nhân viên trực thuộc, làm mới vị trí,
            xóa vị trí, ...</li>
          <li>Bấm vào dấu + bên phải 1 nhân viên nào đó, sẽ tạo thêm 1 nhân viên mới trực thuộc nhân viên đó.</li>
          <li>Bấm vào dấu tam giác dưới 1 nhân viên có người trực thuộc, sẽ ẩn hoặc hiện tất cả mọi nhân viên trực thuộc
            nhân viên đó.</li>
          <li>Bấm đúp vào khoảng trống của sơ đồ tổ chức, sẽ tạo ra 1 nhân viên mới chưa thuộc quản lý của nhân viên
            nào.</li>
          <li>Kéo 1 nhân viên thả lên nhân viên khác, sẽ tạo ra một mối quan hệ quản lý mới.</li>
          <li>Có thể thay đổi mối quan hệ giữa 2 nhân viên thông qua trường parent theo mục 1. Chỉnh sửa từng người ở
            trên.</li>
          <li>Bấm vào sơ đồ tổ chức, sau đó giữ phím Control và kéo lăn chuột sẽ thu phóng sơ đồ đến tỉ lệ tùy chọn.
          </li>
          <li>Có nút thu phóng tiện ích: Căn vừa màn hình hoặc Căn giữa theo sếp. Thu phóng tùy biến bằng tổ hợp Ctrl +
            kéo chuột</li>
          <li>Có nút xuất ra file cấu hình dạng JSON Text (để nạp lại khi cần) và xuất ảnh chất lượng cao SVG sắc nét.
            Ngoài ra cũng có xuất ảnh PNG.</li>
        </ul>
        </p>

        <h4 class="main-text"><i>5. Dữ liệu tạm thời:</i><br></h4>
        <p>
        <ul>
          <li>Những chỉnh sửa được lưu vào bộ nhớ tạm, hãy bấm nút Lấy ra để xem thông tin các bản ghi, bạn có thể sao
            chép.</li>
          <li>Nếu đã chuẩn bị dữ liệu có cấu trúc tương tự (như đã sao chép 1 lần nào đó), hãy dán vào và bấm nút Tải
            vào để cập nhật toàn bộ sơ đồ.</li>
        </ul>
        </p>
      </div>


      <div>
        <div>
          <button id="SaveButton" onclick="save()">Lấy ra</button>
          <button onclick="load()">Tải vào</button>
          Sơ đồ tổ chức dạng text JSON từ các chỉnh sửa:
        </div>
        <textarea id="mySavedModel" style="width:100%; height:270px;">
          {"class":"go.TreeModel","nodeDataArray":[{"key":1,"Full_Name":"LAZINET","Professional_Title":"TECHNOLOGIES","Department_Team":"Sơ đồ tổ chức","Lead_Title":"Sơ đồ tổ chức","Portrait_URL":"../assets/img/logo-lazinet/lazinet_LogoOnly_bgWhite_Buffer.svg"},{"key":2,"Full_Name":"Hoàng Minh Phụng","Professional_Title":"Innovation Principal","Department_Team":"BOD","Lead_Title":"CEO","parent":1,"Portrait_URL":"../assets/img/team/Phung-Hoang.png","Profile_URL":"https://lazinet.com/bizcards/phung-hoang"},{"key":3,"Full_Name":"Tăng Phương Mai","Professional_Title":"Operation Director","Department_Team":"BOD","Lead_Title":"COO","parent":2,"Portrait_URL":"../assets/img/team/Mai-Tang-Square.jfif","Profile_URL":"https://lazinet.com/bizcards/lazinet_mai-tang"},{"key":4,"Full_Name":"TS. Phùng Thế Bảo","Professional_Title":"Data & AI Researcher","Department_Team":"BOD","Lead_Title":"CTO","parent":2,"Portrait_URL":"../assets/img/team/Bao-Phung-RB1.png","Profile_URL":"https://lazinet.com/bizcards/lazinet_bao-phung"},{"key":5,"Full_Name":"Nguyễn Đình Thắng","Professional_Title":"Project Development","Department_Team":"BOD","Lead_Title":"CSO","parent":2,"Portrait_URL":"../assets/img/team/Thang-Nguyen.webp","Profile_URL":"https://lazinet.com/bizcards/lazinet_thang-nguyen"},{"key":6,"Full_Name":"Ánh Văn","Professional_Title":"Operation Manager","Department_Team":"Operations","parent":3,"Portrait_URL":"../assets/img/team/Anh-Van-41-RB1.png"},{"key":7,"Full_Name":"Linh Giang","Professional_Title":"Operation Executive","Department_Team":"Operations","parent":3,"Portrait_URL":"../assets/img/team/HoTLinhGiang.png","Profile_URL":"https://lazinet.com/bizcards/hathyo-linh-giang"},{"key":8,"Full_Name":"Trọng Nguyễn","Professional_Title":"Technology Manager","Department_Team":"Technology","parent":4,"Portrait_URL":"../assets/img/team/Trong-Nguyen-RB1.png","Profile_URL":"https://lazinet.com/bizcards/hathyo-trong-nguyen"},{"key":9,"Full_Name":"Li Nguyễn","Professional_Title":"Solution Architect Expert","Department_Team":"Technology","parent":4,"Portrait_URL":"../assets/img/team/Li-Nguyen.jpg","Profile_URL":"https://lazinet.com/bizcards/lazinet_hung-le"},{"key":10,"Full_Name":"Duy Nguyễn","Professional_Title":"Software Developer","Department_Team":"Technology","parent":14,"Portrait_URL":"../assets/img/team/Duy-Nguyen-RB1.png"},{"key":11,"Full_Name":"Bảo Trần","Professional_Title":"Software Developer","Department_Team":"Technology","parent":8,"Portrait_URL":"../assets/img/team/bao-tran.png"},{"key":12,"Full_Name":"Triết Đặng","Professional_Title":"Software Developer","Department_Team":"Technology","parent":14,"Portrait_URL":"../assets/img/team/triet-dang.png"},{"key":13,"Full_Name":"Nhân Nguyễn","Professional_Title":"AI Developer","Department_Team":"Technology","parent":8,"Portrait_URL":"../assets/img/team/nhan-nguyen.png"},{"key":14,"Full_Name":"Hùng Lê","Professional_Title":"Technology Manager","Department_Team":"Technology","parent":4,"Portrait_URL":"../assets/img/team/Hung-Le-2-RB1.png","Profile_URL":"https://lazinet.com/bizcards/lazinet_hung-le"},{"key":15,"Full_Name":"Khoa Vũ","Professional_Title":"Software Developer - GIS","Department_Team":"Technology","parent":8,"Portrait_URL":"../assets/img/team/Khoa-Vu.webp"},{"key":16,"Full_Name":"Vinh Lê","Professional_Title":"Business Advisor","Department_Team":"Business","parent":5,"Portrait_URL":"../assets/img/team/Vinh-Le.webp","Profile_URL":"https://lazinet.com/bizcards/lazinet_vinh-le"},{"key":17,"Full_Name":"Nguyên Hoàng","Professional_Title":"Infrastructure Expert","Department_Team":"Technology","parent":5,"Portrait_URL":"../assets/img/team/Nguyen-Hoang-2.webp"},{"key":18,"Full_Name":"Vũ Nguyễn","Professional_Title":"Senior Developer - PM","Department_Team":"Operations","parent":5,"Portrait_URL":"../assets/img/team/Vu-Nguyen-Crop.jpg","Profile_URL":"https://lazinet.com/bizcards/lazinet_vinh-le"},{"key":19,"Full_Name":"Nga Lê","Professional_Title":"Operation Executive","Department_Team":"Operations","parent":3,"Portrait_URL":"../assets/img/team/Nga-Le5.png"}]}
        </textarea>
        <p class="main-text">
          OrgChart V2.2 &copy; 
          <a href="mailto:email@lazinet.com"><span style="color: #ff6302;"><b>LAZI</b></span><span
              style="color: #0000ff;"><b>NET</b></span></a>
          2024-<script>document.write(new Date().getFullYear());</script>. Built on GoJS
        </p>
      </div>
    </div>
  </div>
</body>

</html>